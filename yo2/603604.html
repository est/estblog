<!DOCTYPE html>
<html>
  <head>
    <title>[Debian Etch]SVN+Apache2.2+MySQLè®¤è¯ é…ç½®æŒ‡å—[mod_authnz_external] - ğŸ‘â€ğŸ—¨ ğŸ’­ ğŸ’« ğŸ…±ã’</title>

    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link href="https://feeds.feedburner.com/initiative" type="application/rss+xml" rel="alternate" title="ğŸ‘â€ğŸ—¨ ğŸ’­ ğŸ’« ğŸ…±ã’ RSS Feed" />

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="[Debian Etch]SVN+Apache2.2+MySQLè®¤è¯ é…ç½®æŒ‡å—[mod_authnz_external]" />

      <link rel="canonical" href="https://blog.est.im/yo2/603604" />

    <link rel="stylesheet" href="/theme/css/normalize.min.css" />
    <link rel="stylesheet" href="/theme/css/style.css" />


    <style>
      body {
        background: #ecedef url("/theme/img/ignasi_pattern_s.png") repeat;
      }
    </style>
  </head>
  <body class="single-body">
<nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="/" class="nav-text">
    ğŸ‘â€ğŸ—¨ ğŸ’­ ğŸ’« ğŸ…±ã’
  </a></h1>
  <div class="hamburger-menu">
    <button onclick="hamburgerMenuPressed.call(this)" aria-haspopup="true" aria-expanded="false" aria-controls="menu" aria-label="Menu">
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="/" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://feeds.feedburner.com/initiative" class="hamburger-menu-overlay-link">RSS</a></li>
      <li><a href="/about" class="hamburger-menu-overlay-link">About</a></li>

      <li><a href="/category/archive" class="hamburger-menu-overlay-link active">archive</a></li>
      <li><a href="/category/stderr" class="hamburger-menu-overlay-link">stderr</a></li>
      <li><a href="/category/stdin" class="hamburger-menu-overlay-link">stdin</a></li>
      <li><a href="/category/stdout" class="hamburger-menu-overlay-link">stdout</a></li>

    </ul>
  </div>
</nav>    <main class="content side-text-padding">


<article class="post">
  <header class="post-header">
    <h2 class="post-title">[Debian Etch]SVN+Apache2.2+MySQLè®¤è¯ é…ç½®æŒ‡å—[mod_authnz_external]</h2>
    <p class="post-date">Posted <time datetime="2007-12-22T16:41:19+08:00">2007-12-22</time> | <span>archive</span></p>
  </header>

  
  <p>é¦–å…ˆè¯´ï¼ŒApache2.2æ”¯æŒHTTPè®¤è¯ï¼Œæ¥æºæœ‰å¤šç§ï¼Œä½†æ˜¯æ”¯æŒç¬¬ä¸‰æ–¹MySQLæ•°æ®è¡¨è®¤è¯çš„MODå°±å°‘äº†ï¼Œ<a href="http://modauthmysql.sourceforge.net/">mod_auth_mysql</a>æ˜¯æœ€è‘—åçš„ï¼Œä¹Ÿæ˜¯æœ€æ—©çƒ‚çš„ï¼Œæˆ‘æ ¹æœ¬åœ¨etchä¸Šç¼–è¯‘ä¸èµ·ï¼›å…¶æ¬¡æ˜¯ <a href="http://packages.debian.org/stable/web/libapache2-mod-auth-pam">libapache2-mod-auth-pam</a> åŠ  <a href="http://packages.debian.org/libpam-mysql">libpam-mysql</a> ï¼Œè¿™ä¸ªä¹Ÿå¤±è´¥ï¼Œå› ä¸ºPAMä¹Ÿåœæ­¢å¼€å‘äº†ã€‚</p>
<p>ç»è¿‡æˆ‘åƒè¾›ä¸‡è‹¦Googleäº†å¤§åŠä¸ªæœˆï¼Œç»ˆäºå‘ç°äº†æœ€å¥½çš„Apache2.2éªŒè¯MODï¼š<a href="http://unixpapa.com/mod_auth_external.html">mod_authnz_external</a>ã€‚</p>
<p>åŸç†å¾ˆç®€å•ï¼Œmod_auth_externalä¼šè°ƒç”¨ä¸€ä¸ªå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚æœå‘½ä»¤ä»¥é”™è¯¯ä»£ç 0é€€å‡ºï¼Œé‚£ä¹ˆéªŒè¯æˆåŠŸï¼›å¦‚æœä»¥é”™è¯¯ä»£ç 1ç­‰ç­‰é€€å‡ºï¼Œé‚£ä¹ˆéªŒè¯å¤±è´¥ã€‚OKï¼Œå¼€å§‹é…ç½®<br>
<code><br>
apt-get install apache2<br>
apt-get install subversion<br>
apt-get install libapache2-svn<br></code><br>
ç¼–è¾‘ <code>vim /etc/apache2/mods-enabled/dav_svn.conf</code><br>
å†…å®¹ä¸º</p>
<pre>
&lt;Location /svn&gt;
  DAV svn
  SVNPath /srv/svn<br>
  AuthName               "Dormforce SVN"
  AuthType               Basic
  AuthBasicProvider      external
  AuthExternal           auth_dormid
  require                valid-user<br>
&lt;/Location&gt;
</pre>
<p>ç°åœ¨ä½ å·²ç»æœ‰ä¸€ä¸ªæ²¡æœ‰authenticationçš„SVNè·‘èµ·æ¥äº†ï¼Œåˆ©ç”¨çš„æ˜¯apache2çš„DAVæ¨¡å—ã€‚</p>
<p>ä¸‹è½½mod_auth_external for apache2.2çš„<a href="http://unixpapa.com/software/mod_authnz_external-3.1.0.tar.gz">æºç åŒ…</a>ã€‚<br>
<code><br>
apt-get install build-essential<br>
apt-get install apache2-threaded-dev<br>
aot-get install apache2-prefork-dev<br></code><br>
ç„¶å <code>tar -xvf mod_authnz_external-3.1.0.tar.gz</code>ï¼Œè¿›å…¥è§£å‹çš„ç›®å½•<br>
<code>apxs -c mod_authnz_external.c<br>
apxs -i -a mod_authnz_external.la</code><br>
ç¼–è¯‘å¥½äº†æ¨¡å—ï¼Œæ¥ä¸‹æ¥å®‰è£…åˆ°Apache2ï¼Œ<code>vim /etc/apache2/mods-enabled/authnz_external.load</code>ï¼Œè¾“å…¥<br>
<code><br>
LoadModule authnz_external_module /usr/lib/apache2/modules/mod_authnz_external.so<br></code></p>
<p>å¥½äº†ï¼Œæˆ‘ä»¬ç¼–è¾‘Apache2ä¸»é…ç½®æ–‡ä»¶<code>vim /etc/apache2/apache2.conf</code><br>
åœ¨æœ€ååŠ ä¸Š<br>
<code><br>
AddExternalAuth auth_dormid /srv/auth_dormid/auth_dormid.py<br>
SetExternalAuthMethod auth_dormid environment<br></code></p>
<p>OKï¼Œè‡ªå·±ç¼–å†™ä¸€ä¸ªå°å°çš„pythonç¨‹åºï¼ŒæŸ¥è¯¢MySQLæ•°æ®åº“ï¼Œå¦‚æœç¯å¢ƒå˜é‡USERå’Œç¯å¢ƒå˜é‡PASSå’Œæ•°æ®åº“ä¸­æŸ¥è¯¢ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆsys.exit(0)ï¼Œå¦åˆ™sys.exit(1)</p>
<p>æµ‹è¯•ä¸€ä¸‹ï¼Œ<code>/etc/init.d/apache2 restart</code>é‡å¯apacheï¼Œçœ‹çœ‹ä½ çš„ç½‘ç«™ /svn ç›®å½•ï¼Œåº”è¯¥å¯ä»¥è®¿é—®SVNå•¦ã€‚</p>
<p>ä¸‹é¢æˆ‘è§£é‡Šä¸‹é…ç½®æ–‡ä»¶é‡Œä¿®æ”¹çš„å†…å®¹å¯¹åº”çš„å«ä¹‰ã€‚<br>
<b>apache2.conf</b><br>
ã€€AddExternalAuth auth_dormid /srv/auth_dormid/auth_dormid.py<br>
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€å…³é”®è¯ã€€ã€€ã€€ã€€ã€€æ‰§è¡Œå‘½ä»¤è·¯å¾„<br>
SetExternalAuthMethod auth_dormid environment<br>
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€å…³é”®è¯ã€€ã€€ã€€é€šè¿‡ç³»ç»Ÿç¯å¢ƒå˜é‡ä¼ é€’è®¤è¯å€¼ï¼ŒåŒæ—¶å¯ä»¥è®¾ç½®ä¸º pipeï¼Œç®¡é“</p>
<p><b>dav_svn.conf</b><br>
AuthName "Dormforce SVN"ã€€è¿™é‡Œæ˜¯æµè§ˆå™¨å¼¹å‡ºçš„æç¤ºçª—å£çš„æ–‡å­—<br>
AuthType Basicã€€ã€€ã€€ã€€ã€€ã€€ã€€HTTP Basicè®¤è¯ï¼Œä½¿ç”¨Basr64åŠ å¯†åä¼ è¾“<br>
AuthBasicProvider externalã€€ã€€ã€€ã€€ã€€è®¤è¯æ¥æºæ˜¯ mod_authnz_external<br>
AuthExternal auth_dormidã€€ã€€ã€€ä¸Šé¢è®¾ç½®çš„ å…³é”®è¯<br>
require valid-userã€€ã€€ã€€ã€€ã€€ã€€éœ€è¦æˆåŠŸè®¤è¯çš„ç”¨æˆ·å’Œå¯†ç æ‰èƒ½è®¿é—®é¡µé¢</p>

</article>


<div class="comments">
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'estblog';
    var disqus_identifier = 'yo2/603604';
    var disqus_url = location.href;
    (function() {
    var dsq = document.createElement('script'); 

    dsq.type = 'text/javascript';
    dsq.defer = true;
    dsq.src = '//estblog.disqus.com/embed.js';
    (document.getElementsByTagName('body')[0] || document.getElementsByTagName('head')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the comments.</noscript>
</div>    </main>
<script src="/theme/js/core.js"></script>

  </body>

</html>