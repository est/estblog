<!DOCTYPE html>
<html">
  <head>
    <title>sshuttle is better ssh -D alternative - Est's Blog</title>

    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <meta charset="utf-8" />
    <link href="https://feeds.feedburner.com/initiative" type="application/rss+xml" rel="alternate" title="Est's Blog RSS Feed" />

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="sshuttle is better ssh -D alternative" />




    <link rel="stylesheet" href="/theme/css/normalize.min.css" />
    <link rel="stylesheet" href="/theme/css/style.css" />


    <style>
      body {
        background: #ecedef url("/theme/img/ignasi_pattern_s.png") repeat;
      }
    </style>
  </head>
  <body class="single-body">
<nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="/" class="nav-text">
    Est's Blog
  </a></h1>
  <div class="hamburger-menu">
    <button onclick="hamburgerMenuPressed.call(this)" aria-haspopup="true" aria-expanded="false" aria-controls="menu" aria-label="Menu">
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="/" class="hamburger-menu-overlay-link">Home</a></li>

        <li><a href="/category/archive.html" class="hamburger-menu-overlay-link active">archive</a></li>
        <li><a href="/category/stderr.html" class="hamburger-menu-overlay-link">stderr</a></li>
        <li><a href="/category/stdin.html" class="hamburger-menu-overlay-link">stdin</a></li>
        <li><a href="/category/stdout.html" class="hamburger-menu-overlay-link">stdout</a></li>

    </ul>
  </div>
</nav>    <main class="content side-text-padding">


<article class="post">
  <header class="post-header">
    <h2 class="post-title">sshuttle is better ssh -D alternative</h2>
    <p class="post-date">Posted <time datetime="2011-04-05T05:24:36+00:00">2011-04-05</time> | <span>archive</span></p>
  </header>

  
  <p>ignw大神以前说过ssh和openvpn性能不行，我当时觉得如果openvpn走tcp连接的话，隧道里的tcp的控制和重发岂不是就没用了？</p>

<p>今天<a href="http://news.ycombinator.com/item?id=2407924">HN上</a>讨论了一个新东东 <a href="https://github.com/apenwarr/sshuttle">sshuttle</a>，一句话介绍：</p>

<p>如果说<code>ssh -D</code>是tcp-over-tcp，那么sshuttle则是data-over-tcp。</p>

<p>详细介绍：</p>

<blockquote>
  <p>But you can't safely just forward TCP packets over a TCP session (like ssh), because TCP's performance depends fundamentally on packet loss; it must experience packet loss in order to know when to slow down! At the same time, the outer TCP session (ssh, in this case) is a reliable transport, which means that what you forward through the tunnel never experiences packet loss. The ssh session itself experiences packet loss, of course, but TCP fixes it up and ssh (and thus you) never know the difference. But neither does your inner TCP session, and extremely screwy performance ensues.</p>

  <p>sshuttle assembles the TCP stream locally, multiplexes it statefully over an ssh session, and disassembles it back into packets at the other end. So it never ends up doing TCP-over-TCP. It's just data-over-TCP, which is safe.</p>
</blockquote>

<p>和VPN相比sshuttle是stateful的，和ssh相比sshuttle lets you use the "real" IP addresses of each host rather than faking port numbers on localhost.</p>

<p><a href="http://news.ycombinator.com/item?id=2409090">还有</a>一篇essay说为神马<a href="http://sites.inka.de/bigred/devel/tcp-tcp.html">TCP Over TCP Is A Bad Idea</a>。简单的说，就是双层数据丢包性能底下。</p>

</article>


<div class="comments">
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'estblog';
    var disqus_identifier = 'archives/3875';
    var disqus_url = location.href;
    (function() {
    var dsq = document.createElement('script'); 

    dsq.type = 'text/javascript';
    dsq.defer = true;
    dsq.src = '//estblog.disqus.com/embed.js';
    (document.getElementsByTagName('body')[0] || document.getElementsByTagName('head')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the comments.</noscript>
</div>    </main>
<script src="/theme/js/core.js"></script>
<script type="text/javascript">
    if(location.protocol === "http:") location.protocol = "https:"
</script>

  </body>

</html>