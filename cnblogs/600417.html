<!DOCTYPE html>
<html>
  <head>
    <title>[原创]Windows的11种快捷方式（2006-12-21修订版） – est の 输入 输出和出入</title>

    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link href="https://feeds.feedburner.com/initiative" type="application/rss+xml" rel="alternate" title="est の 输入 输出和出入 RSS Feed" />

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="[原创]Windows的11种快捷方式（2006-12-21修订版）" />

    <link rel="canonical" href="https://blog.est.im/cnblogs/600417" />
    <meta property="og:url" content="https://blog.est.im/cnblogs/600417">
    <meta property="og:type" content="article">
    <meta property="og:title" content="[原创]Windows的11种快捷方式（2006-12-21修订版）">

    <link rel="stylesheet" href="/theme/css/normalize.min.css" />
    <link rel="stylesheet" href="/theme/css/style.css" />


    <style>
      body {
        background: #ecedef url("/theme/img/ignasi_pattern_s.png") repeat;
      }
    </style>
  </head>
  <body class="single-body">
<nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="/" class="nav-text">
    est の 输入 输出和出入
  </a></h1>
  <div class="hamburger-menu">
    <button>
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="/" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://feeds.feedburner.com/initiative" class="hamburger-menu-overlay-link">RSS</a></li>
      <li><a href="/about" class="hamburger-menu-overlay-link">About</a></li>

      <li><a href="/category/archive" class="hamburger-menu-overlay-link active">archive</a></li>
      <li><a href="/category/stderr" class="hamburger-menu-overlay-link">stderr</a></li>
      <li><a href="/category/stdin" class="hamburger-menu-overlay-link">stdin</a></li>
      <li><a href="/category/stdout" class="hamburger-menu-overlay-link">stdout</a></li>

    </ul>
  </div>
</nav>    <main class="content side-text-padding">
<article class="post">
  <header class="post-header">
    <h2 class="post-title">[原创]Windows的11种快捷方式（2006-12-21修订版）</h2>
    <p class="post-date">Posted <time datetime="2006-12-22T05:52:00+08:00">2006-12-22</time> | <span>archive</span></p>
  </header>

  
  <p>&nbsp;<style type="text/css"></p>
<!--
div.Section1
{}
h3
{margin-bottom:.0001pt;
text-align:center;
page-break-after:avoid;
font-size:12.0pt;
font-family:"Times New Roman"; margin-left:0in; margin-right:0in; margin-top:0in}
span.SpellE
{}
h2
{margin-bottom:.0001pt;
page-break-after:avoid;
font-size:12.0pt;
font-family:"Times New Roman"; margin-left:0in; margin-right:0in; margin-top:0in}
-->
</style>
<p>快捷方式，很多人的反映就是那个小箭头，其实Windows支持9种快捷方式。</p>
<p>关于这个格式</p>
<p><font size="4">1. *.lnk<br/>
</font>这是微软的通用快捷方式，很多电脑初学者当年就是把一个500MB的游戏在桌面上的1k大小的快捷方式复制到软盘里，然后回家双击打开一看，发现Windows提示&ldquo;找不到路径&rdquo;云云。后来才明白这只是个快捷方式。</p>
<p>在命令行里打开一个 lnk 文件： Rundll32.exe url.dll, FileProtocolHandler %L</p>
<p>lnk 的二进制格式 <a style="BEHAVIOR: url(http://202.115.22.199/FCKeditor/editor/css/behaviors/anchors.htc)" href="http://www.vckbase.com/document/viewdoc/?id=1411">http://www.vckbase.com/document/viewdoc/?id=1411</a></p>
<p>其实 .LNK根 Windows Shell&nbsp;的关系比较紧密，在 Windows Vista 里，很多 Shell&nbsp;对象都可以通过 .lnk 文件来打开，所以 lnk 文件里全部是用 CLSID 作为引导</p>
<p>在wsh/vbs里操作 .lnk 文件 <a style="BEHAVIOR: url(http://202.115.22.199/FCKeditor/editor/css/behaviors/anchors.htc)" href="http://download.microsoft.com/download/winscript56/Install/5.6/W982KMe/CN/scd56chs.exe">script56.chm::/html/wsconManagingShortcuts.htm</a> <br/>
　</p>
<p><font size="4">2. *.url</font></p>
<p>.url 文件的格式和 .inf 的相似：<br/>
<a href="http://www.cyanwerks.com/file-format-url.html">http://www.cyanwerks.com/file-format-url.html</a></p>
<p><font size="4">3. *.pif</font></p>
<p>这是相当古老的一种格式了<br/>
<a href="http://www.smsoft.ru/en/pifdoc.htm">http://www.smsoft.ru/en/pifdoc.htm</a></p>
<p><font size="4">4. FolderShortcut</font></p>
<p>这个是未公开的一种快捷方式吧，不要理解成 文件夹<strong>的</strong>快捷方式了，我记得是从Win98就开始用这个东东了，貌似是和 Active Desktop 技术一起出现的。国内的首次公开是在这个帖子 <a href="http://bbs.onegreen.net/TopicOther.asp?t=5&amp;BoardID=2&amp;id=1414">http://bbs.onegreen.net/TopicOther.asp?t=5&amp;BoardID=2&amp;id=1414</a>&nbsp;，最简单的 文件夹快捷方式 是把一个文件夹拖放到 开始菜单</p>
<p><img alt="" src="http://202.115.22.199/Blog/Attachment/549"/></p>
<p>如下图：上面那个是直接拖放生成的 文件夹快捷方式，下面的是传统的 lnk 快捷方式。两者的明显不同是： 文件夹快捷方式 是可以在菜单里显示所指向目标文件夹的内容的。</p>
<p><img alt="" src="http://202.115.22.199/Blog/Attachment/550"/></p>
<p><img alt="" src="http://202.115.22.199/Blog/Attachment/551"/></p>
<p>更为可喜的是，文件夹快捷方式没有小箭头！</p>
<p><img alt="" src="http://202.115.22.199/Blog/Attachment/552"/></p>
<p>文件夹快捷方式的属性有点怪怪的呢</p>
<p><img alt="" src="http://202.115.22.199/Blog/Attachment/553"/></p>
<p>手工建立 文件夹快捷方式 的方法：<br/>
1. 在目标文件夹里建立一个 系统 隐藏 属性的 desktop.ini（cmd里 attrib +S +h desktop.ini），内容为：<br/>
[.ShellClassInfo]<br/>
CLSID2={0AFACED1-E828-11D1-9187-B532F1E9575D}<br/>
Flags=2<br/>
2. 保存，建立一个 一般的快捷方式，指向你的目标地址，名称为：target.lnk （必须是这个！）。<br/>
3. 把该文件夹设为 只读 属性</p>
<p>貌似文件夹快捷方式只能指向 文件夹 和 URL，不能指向文件。其实 文件夹快捷方式用在黑克攻防领域是相当的爽的，特别是结合 .lnk .url 的一些溢出，几乎是百发百中！（谁会想到，打开一个文件<strong>夹</strong>也会中病毒？）</p>
<p><font size="4">5. HardLink</font></p>
<p>NTFS的一大特性。在XP下可以通过 fsutil 建立（需要管理员权限）。</p>
<p>C:\WINDOWS\system32&gt;fsutil hardlink create<br/>
用法 : fsutil hardlink create &lt;新文件名&gt; &lt;现有文件名&gt;<br/>
例如 : fsutil hardlink create c:\foo.txt c:\bar.txt</p>
<p>HardLink有什么用呢？可以把<strong>一个</strong>文件，放到很多目录下，但是只占一个文件的空间，有点像那些 n 合 1 的光盘的原理。所以hardlink可以用来骗人啦，例如，我把我的一个2GB的GHOST镜像文件hardkink 1000次，那么我看这些所有文件的属性就是一个 2TB 啦，呵呵，其实我的硬盘没这么大。Hardlink 可以用来解决很多问题。比如说，系统里很多 dll 是重复的，我们就可以把一个 dll 做成很多 hardlink，这样可以大大的节省空间。需要注意的是，Hardlink 只实用于NTFS的分区，一个文件只能被Hardlink 1024ci ，而且只能在同一分区建立。</p>
<p><font size="4">6. Junction Point </font></p>
<p>相比于Hardlink，Junction Point 可以看作文件夹的硬连接吧，Vista里 Junction 已经被完全的符号连接取代了。</p>
<p><font size="4">7. Reparse Point</font></p>
<p>和Hardlink有点类似，不过是针对文件夹的，还是fsutil命令来管理</p>
<p>C:\WINDOWS\system32&gt;fsutil reparsepoint<br/>
---- 支持的 REPARSEPOINT 命令 ----</p>
<p>query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查询重分析点<br/>
delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 删除重分析点</p>
<p>不过要建立的话，可以通过SysInternals的又一款作品&nbsp;<a href="http://www.sysinternals.com/files/junction.zip">http://www.sysinternals.com/files/junction.zip</a>&nbsp; 来建立</p>
<p><font size="4">8. Symbolic Links</font></p>
<p>符号连接允许你创建一个指针(pointer)，从目录的一个位置指向实际上位于别处的文件。NTFS并没有真正实现类似于UNIX系统中的符号连接，但通过重解析点，这种功能被模拟出来。实际上，一个符号连接就是一个重解析点，它将对一个文件的访问重定向到另一个文件。</p>
<p><font size="4">9. Mount Point</font></p>
<p>可以通过 mountvol 命令来管理。严格的说这已经不是快捷方式了，不过可以把一个储存媒体挂载到一个NTFS的文件夹下。</p>
<p><font size="4">9. Shell Object</font></p>
<p><font size="2">其实呢，&ldquo;字体&rdquo;文件夹就是一种典型的 Shell 对象。下载<a href="http://dormforce.net/Blog/Attachment/611">ShellExtView</a> ， <a href="http://dormforce.net/Blog/Attachment/612">ShellObjectEditor</a></font></p>
<p><font size="4">10. Shell Command</font></p>
<p>常见的有</p>
<p>显示桌面.csf，内容为：<br/>
[Shell] <br/>
Command=2 <br/>
IconFile=explorer.exe,3 <br/>
[Taskbar] <br/>
Command=ToggleDesktop </p>
<p>改文件会DDE调用explorer来显示桌面</p>
<p>查看频道.scf</p>
<p>[Shell]<br/>
Command=3<br/>
IconFile=shdocvw.dll,-118</p>
<p>[IE]<br/>
Command=Channels</p>
<p>explorer.scf</p>
<p><br/>
[Shell]<br/>
Command=2<br/>
IconFile=explorer.exe,1</p>
<p>[Taskbar]<br/>
Command=Explorer</p>
<p>&nbsp;我总觉得 .scf 根 GNOME里的 .desktop 文件很相似呢，呵呵</p>
<p>还有一种是复制文件的时候，拖放对象的一种特殊快捷方式，这类快捷方式都是 0 字节的文件，也是通过DDE调用的。例如：<br/>
我的文档.mydocs<br/>
ZIP压缩文件夹.ZFSendToTarget<br/>
桌面.desklink<br/>
邮件.mapmail<br/>
</p>
<p>Windows所支持的快捷方式基本上就这些了，快捷方式以极小的代价把一个文件在不同的位置展现了出来，给系统的使用带来了很大的方便，同时也带来了很多未知的安全隐患。如果有时间的话，下次继续，<a href="http://dormforce.net/blog/electronixtar">《快捷方式攻防战》</a></p>
<p>[内有附件]</p>
</article>

<div class="comments">
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'estblog';
    var disqus_identifier = 'cnblogs/600417';
    var disqus_url = location.href;
    (function() {
    var dsq = document.createElement('script'); 

    dsq.type = 'text/javascript';
    dsq.defer = true;
    dsq.src = '//estblog.disqus.com/embed.js';
    (document.getElementsByTagName('body')[0] || document.getElementsByTagName('head')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the comments.</noscript>
</div>    </main>

  </body>

</html>