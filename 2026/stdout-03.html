<!DOCTYPE html>
<html>
  <head>
    <title>尝试让AI手搓个TTF格式生成器 – est の 输入 输出和出入</title>
<link rel="icon" href="https://est.im/favicon.svg">
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta http-equiv="Content-Security-Policy" content="frame-ancestors 'self' https://disqus.com https://player.bilibili.com https://www.youtube.com;">
    <link href="https://feeds.feedburner.com/initiative" type="application/rss+xml" rel="alternate" title="est の 输入 输出和出入 RSS Feed" />

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="尝试让AI手搓个TTF格式生成器" />

    <link rel="canonical" href="https://blog.est.im/2026/stdout-03" />
    <meta property="og:url" content="https://blog.est.im/2026/stdout-03">
    <meta property="og:type" content="article">
    <meta property="og:title" content="尝试让AI手搓个TTF格式生成器">

    <link rel="stylesheet" href="/theme/css/normalize.min.css" />
    <link rel="stylesheet" href="/theme/css/style.css" />


    <style>
      body {
        background: #ecedef url("/theme/img/ignasi_pattern_s.png") repeat;
      }
    </style>
  </head>
  <body class="single-body">
<nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="/" class="nav-text">
    est の 输入 输出和出入
  </a></h1>
  <div class="hamburger-menu">
    <button>
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="/" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://feeds.feedburner.com/initiative" class="hamburger-menu-overlay-link">RSS</a></li>
      <li><a href="/about" class="hamburger-menu-overlay-link">About</a></li>
      <li><a href="/category" class="hamburger-menu-overlay-link">Category</a></li>

    </ul>
  </div>
</nav>    <main class="content side-text-padding">
<article class="post">
  <header class="post-header">
    <h2 class="post-title">尝试让AI手搓个TTF格式生成器</h2>
    <p class="post-date">Posted <time datetime="2026-01-14T22:48:00+08:00">2026-01-14</time> | <span>stdout</span></p>
  </header>

  
  <p>一个奇怪的需求：如何在浏览器判断一个字体是否支持某个字符？</p>
<p>一开始以为很easy，让 ChatGPT搓，打开浏览器就懵逼 </p>
<pre><code>OTS parsing error: bad table directory searchRange
bad table directory entrySelector
bad table directory rangeShift
Invalid table tag: 0x66000000
f\x00\x00\x00: invalid table offset
</code></pre>
<p>感觉事情没那么简单。让Antigravity搓，它把我免费额度烧光了也没搓出个所以然</p>
<p>其中一个小插曲是，css里允许对单独一个字符设置 <code>font-family</code>，但是因为这个 .ttf 是动态生成的，所以需要动态生成这个CSS的声明，所以在生成 .ttf 之后需要类似这样的代码：</p>
<pre><code>document.head.insertAdjacentHTML(&quot;beforeend&quot;, `
&lt;style&gt;
@font-face {
  font-family: GhostRaw;
  src: url(${url});
  unicode-range: U+2603;
}
body { font-family: GhostRaw, system-ui; }
&lt;/style&gt;
`);
</code></pre>
<p>注意这个是在 html 里的 js 里的 template string 里的 css。antigravity改这一块出现了好多次 error，我猜是AI输出格式嵌套格式本来就容易出错，这里引用和转义太复杂以至于 agent 直接看不懂output了。哈哈</p>
<p>因为没额度了，所以换国产免费的 Trae。Trae 比antigravity更笨，但是也努力。js搓不动，就开始换写 .py 去验证。搞到最后搞出来一堆测试文件</p>
<p>check_maxp.py<br />
check_validation.py<br />
generate_minimal_ttf.py<br />
generate_proper_ttf.py<br />
generate_simple_zero_width_font.py<br />
generate_ttf.js<br />
generate_zero_width_font.py<br />
generated_font.ttf<br />
generated_font.ttx<br />
get_base64.js<br />
minimal_font_generator.py<br />
modify_existing_font.py<br />
simple_font_generator.py<br />
validate_ttf.py<br />
validate.js<br />
working_font_generator.py<br />
zero_width_font.ttf<br />
zero-width.ttf</p>
<p>这样几回合下来，直接搓超出上下文了，最后直接罢工，出现</p>
<blockquote>
<p>Output is too long, please enter 'Continue' to get more.</p>
</blockquote>
<p>而且你点了 continue 它思索半天还是出现这句话。上下文是彻底爆了。</p>
<p>正向构造一个 .ttf 很难，AI还很聪明的想到了：</p>
<blockquote>
<p>我将使用一个更简单的方法，直接使用一个现有的基础字体文件，然后修改它的字符映射。让我检查一下是否有任何基础 TTF 文件可用。我将使用 Google Fonts 中的一个非常简单的字体作为基础。</p>
</blockquote>
<p>最后还是失败了。于是我就去搜索引擎找到了这个：</p>
<p><a href="https://pomax.github.io/Minimal-font-generator/">https://pomax.github.io/Minimal-font-generator/</a></p>
<blockquote>
<p>dynamically generated bespoke font that encodes that character as a zero-width glyph<br />
in the PDF.js project, where a PDF file may have fonts embedded for rendering text with, but no way to tell whether an extracted font has actually finished loading.</p>
</blockquote>
<p>和我想到一块去了。还是人类老哥牛逼，2012-01-14号就把这个方案搓出来了，距今刚好整整14年。</p>
<p>AI就像一个培训班出身的，对背题能过的任务能很快完成，对于这种考验细节的冷门任务，还是难。</p>
</article>

<div class="comments">
  <h2>Comments</h2>
  <script type="text/javascript" defer src="https://c.est.im/req4cmt.js"></script>
</div>    </main>


  </body>

</html>