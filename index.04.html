<!DOCTYPE html>
<html>
  <head>
    <title>est の 输入 输出和出入</title>

    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link href="https://feeds.feedburner.com/initiative" type="application/rss+xml" rel="alternate" title="est の 输入 输出和出入 RSS Feed" />

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="This blog is rated 🔞, viewer discretion is advised" />

    <meta property="og:url" content="https://blog.est.im">
    <meta property="og:type" content="website">
    <meta property="og:title" content="est の 输入 输出和出入">
    <meta property="og:description" content="This blog is rated 🔞, viewer discretion is advised">

    <link rel="stylesheet" href="/theme/css/normalize.min.css" />
    <link rel="stylesheet" href="/theme/css/style.css" />


    <style>
      body {
        background: #ecedef url("/theme/img/ignasi_pattern_s.png") repeat;
      }
    </style>
  </head>
  <body class="list-body">
<nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="/" class="nav-text">
    est の 输入 输出和出入
  </a></h1>
  <div class="hamburger-menu">
    <button>
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="/" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://feeds.feedburner.com/initiative" class="hamburger-menu-overlay-link">RSS</a></li>
      <li><a href="/about" class="hamburger-menu-overlay-link">About</a></li>

      <li><a href="/category/archive" class="hamburger-menu-overlay-link">archive</a></li>
      <li><a href="/category/stderr" class="hamburger-menu-overlay-link">stderr</a></li>
      <li><a href="/category/stdin" class="hamburger-menu-overlay-link">stdin</a></li>
      <li><a href="/category/stdout" class="hamburger-menu-overlay-link">stdout</a></li>

    </ul>
  </div>
</nav>    <main class="card-container side-gutter">
      <header class="list-header">
        <p class="list-header-subtext">This blog is rated 🔞, viewer discretion is advised</p>
        <!-- <h1 class="list-header-title">est の 输入 输出和出入</h1> -->
      </header>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2024/stderr-03"  rel="bookmark" >
              <h2 class="card-title">Deal with the world</h2>
            </a>
            <p class="card-text"><p>Disclaimer: ESL speaker with bad English writing skills. This rant is "Organic🌱🌿♻️🍃" produced and has not be auto-corrected by spell-checkers nor AI/LLM chemicals.</p>
<p>I engage with online arguments from strangers on the Interweb from time to time. Some of replies I receive often is "Essence of Leverage", a slang/meme in Chinese which resembles "trolling". I confess I did do this on purpose in order to consume my bordom and adjust my low self-esteem. During <a href="https://www.v2ex.com/t/1015322">today's heated back &amp; forth replies</a>, the thread was moved to flamewar section, the opposition laughed me for been too childish like a tolder, or too old like a stuborn 40yo, which if funny, because apparently there's <a href="archives/2993.html">something wrong</a> that urgently needs correction?</p>
<p>Calling me old might <em>ouch</em> me if I were younger, but now it's hurting less, maybe just a meh. In retrospection, I came to the conclusion that there are two stages of world-view: for young adults, there's a strong opinion that some part of the world is wrong, and there's strong motivation of pursuade others how the world <strong>should be</strong>. Few years back I was in that precise state, I spent hours and days battling speech from others, like to defend my faith or something, hoping to achieve something out of it.</p>
<p>As age grows, I found stalemate , and hopefully peace. There's nothing wrong with the world, in fact that the world is inperfect by design, our brain is modeling the world in a causuality-reality way. But physical world can't always be encapsulated in matters of verbatim reasons, shit happens all the time for no reason. and would never go the way with most people's wish. There's little one could do to change it, maybe at special occasions, by some extreme luck, chosen ones can play a role in some social movement showing how the world <strong>could be</strong>.</p>
<p>This brings up my favorite  episodes from 2023, <em>What If</em> from Marvel Studios. There are so many possibilities for each alternate story line. So in real life, why do we have to assign ourselves to the fixed label given by desiganated social hierarchy? Does 40yo have to be wise and know-all? Does opinions from adults have to be affirmative? I think it's not. People grow up accustomed with education background and socio-economic environments, and get used and blind-folded by it. Staying curious and foolish is the key to jump out of the circle. Challenge one's world-view and vice-versa is benificial for one's own good, and especially so in "collective" culture sphere of China, but changing others' is a waste of time.</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2024-02-11T22:52:00+08:00">2024-02-11</time></p>
<p>stderr</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2024/stdout-01"  rel="bookmark" >
              <h2 class="card-title">FastAPI/Starlette 长连接感知断开</h2>
            </a>
            <p class="card-text"><p>之前写过如何 <a href="/2023/stdout-12">在服务器重启的时候感知长连接</a>，最近发现折腾复杂了。</p>
<p><a href="https://github.com/encode/starlette/discussions/1776">https://github.com/encode/starlette/discussions/1776</a></p>
<p>测试代码： </p>
<pre><code>import asyncio

async def async_streamer():
    try:
        while True:
            yield b&quot;--boundary\r\nContent-Type: text/plain\r\nContent-Length: 1\r\n\r\n1\r\n&quot;
            await asyncio.sleep(0)
    except asyncio.CancelledError:
        print(&quot;caught cancelled error&quot;)

app = Starlette(routes=[
    Route('/async', async_endpoint),
])
</code></pre>
<p>跑起来： <code>uvicorn stream:app</code></p>
<p>这段代码粗一看没啥大不了的，但是神奇的地方在于，如果去掉 <code>try ... except asyncio.CancelledError</code> ，代码也能正常跑</p>
<pre><code>
async def async_streamer():
    while True:
        yield b&quot;--boundary\r\nContent-Type: text/plain\r\nContent-Length: 1\r\n\r\n1\r\n&quot;
        await asyncio.sleep(0)
</code></pre>
<p>而且不会报错！最蛋痛的是，这玩意因为是个 <code>while True</code>，如果你里面有打开的数据库连接，是不会中断的，也不会回收的。因为这个 coroutine 没有继续 <code>async for</code> 来消费，就一直挂在进程里当僵尸了！</p>
<p>加上 <code>try ... except asyncio.CancelledError</code>，能捕获出错，也能处理善后了。</p>
<p>真是神奇啊。不知道是 uvicorn 的特性，还是 ASGI 都这样。</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2024-01-18T14:44:12+08:00">2024-01-18</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2024/stderr-02"  rel="bookmark" >
              <h2 class="card-title">碎碎念一下《年会不能停》，微剧透</h2>
            </a>
            <p class="card-text"><p>首先，《年会不能停》是一部喜剧电影。不是纪录片。在这个设定下，我可以给这个喜剧片9分。它给我带来2个小时的吸引力和快乐，这一点就很值。</p>
<p>我去看之前还四处查阅了是否适合带小孩和长辈去看。看完的结论是全家看得其乐融融毫无压力。那么多职场黑话丝毫不妨碍非职场人群理解故事。</p>
<p>然后说几点感受吧。</p>
<p>第一，女一号感觉是硬安排的。对剧情推动作用不大。但是形象好气质佳，很让人看得下，去从而忍受角色定位问题和演技问题。</p>
<p>然后，整个剧情背景设定，某个大公司要裁员。感觉这个矛盾是整个剧情有意回避了，虽然最后是大团圆解决，但是没能回答一个根本的问题：”打工人胜利了，公司的前景会变好吗？“ 如果你认真考虑这个问题，发现剧里的反派一号的苦衷了。喜剧的内核都是悲剧啊。</p>
<p>其次，我觉得董事长的设定偏故事性了。年会不能停，出这么大个事，就这样过去了？不说面子上挂不住的问题，股价，或者资方，还有供应商关系都会栽个大跟斗吧。不乐观。当然网上更有趣的是借题发挥，比如豆瓣这条评论很经典：</p>
<blockquote>
<p><a href="https://www.douban.com/people/riflee1/?">李下</a> 看过  2023-12-31 08:49:16 四川 14750 有用 <br />
恶只到宰相，皇帝是被蒙蔽且善的。</p>
</blockquote>
<p>哈哈哈。上面本意是好的，就是下面执行歪了。</p>
<p>最后，我想稍微深入讨论一个情节，「优化厂里技术最牛的人」，我感觉比较……假。技术最牛的，应该是不怕丢工作的，在哪里不是干活。技术最牛的既然摆明了要挑事，那么下家多半是找好了。这个时候按照情节需要，面对挽留的 counter-offer，我觉得一般有职场常识的人都会拒掉。因为无论 counter-offer 有多诱人，都会彻底扭转职场地位，属于比正式合同更卖身契的玩意，你的劳资关系从双方情愿变成了单向奔赴。以后有的是苦吃。</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2024-01-13T22:45:53+08:00">2024-01-13</time></p>
<p>stderr</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2024/stdin-01"  rel="bookmark" >
              <h2 class="card-title">如何摆脱霉运</h2>
            </a>
            <p class="card-text"><p>悲观者总是正确，乐观者总是成功。<a href="https://www.dedao.cn/share/course/article?id=Lpy0edZAG5mnK0wqG9XzD9BkoajY4x">摘抄</a>一些好玩的：</p>
<blockquote>
<p>有一个英国的心理学家，叫理查德·怀斯曼，他也是英国赫特福德大学的教授。他曾经做过一个实验。大概过程是，招募两组人。第一组人，总是觉得自己最近有点倒霉。第二组人，正好相反，总觉得自己运气不错。怀斯曼就请这两组人看同一份报纸，并且给他们一个任务，数数这张报纸里面，一共有多少张照片。结果发现，倒霉组的平均耗时是，两分钟。而幸运组的平均耗时，还不到十秒钟。是幸运组的人眼力特别好吗？并不是。是因为在这张报纸的第二页，有一个巨大的广告，上面写着一行字，别数了，这张报纸上一共有43张照片。为什么倒霉组的人大都没注意到这个信息？有可能是，大家都想着，我本来运气就不太好，可不能分心大意。而幸运组人可能会觉得，四处多看看，又没什么损失，万一有意外发现呢？后来，怀斯曼又做了一组类似的实验。在报纸中间放了一个大广告，上面写着，别数了，告诉实验人员你看到了这行字，就能赢得250英镑。结果，倒霉组的多数人，又错过了这个信息。怀斯曼就得出一个结论，不幸的人，因为太专注于寻找特定的东西，而错过了别的机会。把这个结论再延伸一步，所谓倒霉，就是太执着于某个单一路线，对周围的好事视而不见。而所谓走运，就是不执着于特定目标，并在沿途发现更多的新机会。<br />
借用马斯克的说法，很多人花了很长时间试图解决某个领域的棘手问题。但他们不会去思考有没有办法把这个解决方案应用到其他领域。简单说就是，越开放，越幸运；越执拗，越倒霉。<br />
你可能会说，假如没有目标，没有计划，万一遇到什么变动，岂不是容易做应激反应，到时候损失更大？别着急，目标和应激反应之间，其实有一个折中的思维方式，叫做，踏脚石思维。也就是，在你前往一个目标的路上，你会遇到很多阶段性的发现，每个发现，就像一个踏脚石。但是，这个踏脚石未必会引导你前往最初的目标，它可能指向别的地方。这时，你就得顺着这个踏脚石，往新奇的地方前进。很多了不起的成就，就是这么来的。比如，YouTube最初的设想是，做一个视频约会网站。后来他们发现大家喜欢在上面发五花八门的视频，就干脆改做视频网站。再比如，当年很多人尝试造飞机，发明了专门的飞机技术，但最后造出飞机的莱特兄弟，使用的是造自行车的技术。再比如，雷达上有个驱动磁控管的部件，后来成了微波炉的核心技术。你看，这些成果都不来自最初的计划，而是中途出现的踏脚石。换句话说，面对不确定的环境时，长期的焦虑可以有。但眼前的开放与好奇，也许更重要。什么是面对世界的最好的姿态？借用理查德·费曼的一句话，以最散漫、最不羁、最原创的方式，努力学习你最感兴趣的东西。</p>
</blockquote>
<p>成功大概有两条路，一个是按照悲观者做预期准备，排除一切可能出错的因素，那么剩余的结局必然成功；</p>
<p>另一种就是在成功的边缘疯狂试探，一不小心中了呢？</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2024-01-11T21:10:12+08:00">2024-01-11</time></p>
<p>stdin</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2024/stderr-01"  rel="bookmark" >
              <h2 class="card-title">Start positive</h2>
            </a>
            <p class="card-text"><p>看了 Tom Scott 的 <a href="https://www.youtube.com/watch?v=7DKv5H5Frt0">After ten years, it's time to stop making videos.<br />
</a> 很是感动。他2014年1月4日开始传 youtube 科技类的视频，开始每天一集后来定下来每周一更。多么强大的毅力，才能把一件事坚持10年 streak。</p>
<p>恰好今天也在各种群和X 上看到说「时间的朋友跨年演讲上座率不到1/3」，抛开<a href="https://wx2.sinaimg.cn/large/7a904c3dgy1hlfc1ci9gkj20wc0uwjwt.jpg">事实</a>不谈，突然 B站 就给我推了这个 <a href="https://www.bilibili.com/video/BV1Wa4y1z7iR">我是罗胖罗振宇，我来B站了<br />
</a>。罗胖说他坚持了10年每天在微信上发一段60s语音。我觉得也挺神的。 </p>
<p>恰好看到<a href="https://twitter.com/Fenng/status/1742165438816248242">@Fenng说</a>这个事，他的论点还选还挺好的，这世界终究是由乐观者推动的。虽然贴那个 ChatGPT 作为论据有点。。。。。</p>
<p>2024年对我而言开局十分糟糕。12月孩子陆陆续续咳嗽了快一个月了，最后查出来支原体感冒做雾化、请假输液折腾得不轻，元旦三天假期我也陪着感冒鼻涕（positive了），感觉人到中年身体一年不如一年了，破事一堆接着一堆。今天第一天上班也是头昏眼花无精打采。Tom Scott，罗振宇，Fenng 都不是我最欣赏的那类influencer/大V，你要挑毛病那我也能罗列一大堆，但是不妨碍我觉得这是2024年开端最好的启发：做一个乐观的人，努力去改变。反正都中年老男人了，也没啥好失去的。不要活得那么战战兢兢。</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2024-01-02T23:21:42+08:00">2024-01-02</time></p>
<p>stderr</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stderr-16"  rel="bookmark" >
              <h2 class="card-title">这个糟糕的世界对中年男人的恶意</h2>
            </a>
            <p class="card-text"><p>人到中年，形败气衰，总有一种有心无力的感觉。到了这个年龄段，最大的不舒服就是和这个世界从愈演愈烈的摩擦，变成轰轰烈烈的冲突。</p>
<p>前几天工作上，快下班的时候甲方紧张兮兮找到我要支持一些业务，问就是急。结果我这边调整之后，另外的对接方放鸽子了。我也因为手头忙别的没在意。好巧不巧几天过后，调整导致了业务问题。全责，惨。</p>
<p>你说我懒吧，我它妈居然愿意在下班的时候接需求；你说我不负责吧，不负责我为啥不找个冠冕堂皇的理由推脱掉或者至少拖延一点时间。你说我为啥不仔细一点吧，犯错真的是个概率问题，而且我在对接方跑路的情况下独自也干预不了什么。为啥调整导致了问题，屎山呗。屎山怎么来的？还不都是「紧急需求」日积月累来的。为啥屎山不缝缝补补熨平一点？这玩意不记劳也不记功啊。但归根结底，谁理会这些苦衷啊，只能默默承担。</p>
<p>21点回家吃饭，拿起手机刚刷到学校「抵制洋节」，刚想嗤之以鼻问孩子怎么看，还没开口，孩子就嘀咕，看到国外过节，家家户户在客厅摆一颗圣诞树，抱怨说老爸太抠了。我语塞。想起来之前（实际上是2012年）淘宝买一颗1.5的也就30元也不贵，结果现在一搜，好家伙普遍70、80了。没买到便宜货，比亏钱还难受。顿时心里非常不爽！</p>
<p>吃完饭，丈母娘在抱怨为啥昨晚（因为穷，所以定时在谷电时段启动的）洗碗机没工作。我看了下洗碗机的门没关好，当然不会启动。这件事从来都是反复抱怨，就是舍不得去关一下门。合着因为洗碗机是我买的和推广的，所有鸡毛蒜皮的事都得我来兜底呗。</p>
<p>真是备受打击的一天啊。长大的过程，从来没在乎来自身边的关爱和鼓励，到现在逐渐沦落成指责和嫌弃，才追悔莫及。似乎全世界终究会剥夺老男人的一切，只留下沉甸甸的责任，说的好听点，中年男人是很多人的仰仗和依赖，说得难听点，中年男人唯一的价值就是被索取。或许这就是中年男人的命吧。</p>
<p>今天政策方面发生了大事，《网络游戏管理办法（草案征求意见稿）》搞得鸡飞狗跳，对整个行业的悲观，加剧了心情的低落。</p>
<p>于是又观察到一个点，可能很多聪明的人早早就察觉了老男人迟早被吃干抹净这个事实，所以默契的联合起来形成父权，对关键资源和社会关系形成垄断和卡位。自己辛辛苦苦创造/掠夺/搏取的财富，凭啥要被傻逼们摆布？为什么很多职场女性觉得自己遭到了歧视和不公？因为你被当男人对待了。</p>
<p>喜欢 ownership 是吧，得，职责对等，那就所有权极端化，私有制神圣不可侵犯，最终卷出来几个阶级顶端的胜利者老男人 own 所有人。这可能就是成年人对全世界的一份报复吧。Screw y'all! Fuck this world!</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-12-23T00:44:45+08:00">2023-12-23</time></p>
<p>stderr</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-19"  rel="bookmark" >
              <h2 class="card-title">不能忘却的记忆</h2>
            </a>
            <p class="card-text"><p>由于小爱同学不能导出就挨个手打出来。纪念这个日子。</p>
<p><img alt="" src="/images/2023/stdout-19-01.jpg" /></p>
<p>一年前这几天，孩子和爱人相继病倒，我本来以为苟住了能以幸免结果在家人好转的时候一测体温发现偏高。于是赶紧洗了个澡，把小卧室腾出来，弄好电暖气、电吹风，装满开水壶，把mbp和其它个人物品搬进去，因为我知道接下来的日子将会无比煎熬。</p>
<table>
<thead>
<tr>
<th>date</th>
<th>℃</th>
</tr>
</thead>
<tbody>
<tr>
<td>2022-12-18 16:41</td>
<td>37.3</td>
</tr>
<tr>
<td>2022-12-18 16:43</td>
<td>37.3</td>
</tr>
<tr>
<td>2022-12-18 17.31</td>
<td>38.1</td>
</tr>
<tr>
<td>2022-12-18 17:46</td>
<td>38.3</td>
</tr>
<tr>
<td>2022-12-18 18:33</td>
<td>39.3</td>
</tr>
<tr>
<td>2022-12-18 18.41</td>
<td>38.7</td>
</tr>
<tr>
<td>2022-12-18 19:07</td>
<td>38.3</td>
</tr>
<tr>
<td>2022-12-18 19:15</td>
<td>38.7</td>
</tr>
<tr>
<td>2022-12-18 20:01</td>
<td>38.6</td>
</tr>
<tr>
<td>2022-12-18 21:11</td>
<td>39.5</td>
</tr>
<tr>
<td>2022-12-18 21:20</td>
<td>38.9</td>
</tr>
<tr>
<td>2022-12-18 21:26</td>
<td>39.1</td>
</tr>
<tr>
<td>2022-12-18 21:41</td>
<td>39.2</td>
</tr>
<tr>
<td>2022-12-18 23:30</td>
<td>38.4</td>
</tr>
<tr>
<td>2022-12-19 02:38</td>
<td>39.3</td>
</tr>
<tr>
<td>2022-12-19 02:48</td>
<td>38.3</td>
</tr>
<tr>
<td>2022-12-19 10:05</td>
<td>38.5</td>
</tr>
<tr>
<td>2022-12-19 10:12</td>
<td>37.9</td>
</tr>
<tr>
<td>2022-12-19 10:36</td>
<td>37.4</td>
</tr>
<tr>
<td>2022-12-19 11:19</td>
<td>37.7</td>
</tr>
<tr>
<td>2022-12-19 14:03</td>
<td>37.7</td>
</tr>
<tr>
<td>2022-12-19 14:29</td>
<td>37.0</td>
</tr>
<tr>
<td>2022-12-19 15:18</td>
<td>37.7</td>
</tr>
<tr>
<td>2022-12-19 16:33</td>
<td>37.6</td>
</tr>
<tr>
<td>2022-12-19 18:05</td>
<td>38.1</td>
</tr>
<tr>
<td>2022-12-19 18:44</td>
<td>37.8</td>
</tr>
<tr>
<td>2022-12-19 19:12</td>
<td>37.2</td>
</tr>
<tr>
<td>2022-12-19 19:47</td>
<td>37.8</td>
</tr>
<tr>
<td>2022-12-19 20:00</td>
<td>37.6</td>
</tr>
<tr>
<td>2022-12-19 21:09</td>
<td>37.2</td>
</tr>
<tr>
<td>2022-12-19 21:44</td>
<td>37.2</td>
</tr>
<tr>
<td>2022-12-19 22:57</td>
<td>36.9</td>
</tr>
<tr>
<td>2022-12-20 00:19</td>
<td>37.2</td>
</tr>
<tr>
<td>2022-12-20 06:55</td>
<td>37.1</td>
</tr>
<tr>
<td>2022-12-20 09:03</td>
<td>37.0</td>
</tr>
<tr>
<td>2022-12-20 09:34</td>
<td>37.0</td>
</tr>
<tr>
<td>2022-12-20 10:49</td>
<td>36.8</td>
</tr>
<tr>
<td>2022-12-20 11:41</td>
<td>38.0</td>
</tr>
<tr>
<td>2022-12-20 11:59</td>
<td>38.4</td>
</tr>
<tr>
<td>2022-12-20 14:47</td>
<td>38.6</td>
</tr>
<tr>
<td>2022-12-20 15:51</td>
<td>38.1</td>
</tr>
<tr>
<td>2022-12-20 16:32</td>
<td>38.0</td>
</tr>
<tr>
<td>2022-12-20 18:22</td>
<td>38.3</td>
</tr>
<tr>
<td>2022-12-20 22:31</td>
<td>38.4</td>
</tr>
<tr>
<td>2022-12-21 09:12</td>
<td>38.1</td>
</tr>
<tr>
<td>2022-12-21 09:59</td>
<td>38.2<code>*</code></td>
</tr>
<tr>
<td>2022-12-21 11:57</td>
<td>38.2</td>
</tr>
<tr>
<td>2022-12-21 13:46</td>
<td>37.5</td>
</tr>
<tr>
<td>2022-12-21 15:10</td>
<td>37.5</td>
</tr>
<tr>
<td>2022-12-21 16.44</td>
<td>37.2</td>
</tr>
<tr>
<td>2022-12-21 17:07</td>
<td>37.0</td>
</tr>
<tr>
<td>2022-12-21 20:37</td>
<td>37.2</td>
</tr>
<tr>
<td>2022-12-21 20:54</td>
<td>37.7</td>
</tr>
<tr>
<td>2022-12-21 22:54</td>
<td>38.3</td>
</tr>
<tr>
<td>2022-12-21 23:05</td>
<td>38.4</td>
</tr>
<tr>
<td>2022-12-22 09:23</td>
<td>36.7</td>
</tr>
<tr>
<td>2022-12-22 09:43</td>
<td>37.3</td>
</tr>
<tr>
<td>2022-12-22 12:44</td>
<td>37.6</td>
</tr>
</tbody>
</table>
<p><code>*</code>: 布洛芬已用完</p>
<p>可能大家只是看到一串冷冰冰的数字，但是我打字都是颤抖的，每一刻时间和体温都是刻骨铭心的记忆。</p>
<p>NEVER FORGET!</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-12-21T20:43:47+08:00">2023-12-21</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-18"  rel="bookmark" >
              <h2 class="card-title">京加高铁</h2>
            </a>
            <p class="card-text"><p>今天了解到这么一件事，白令海峡原来也就 82.5km 宽，水深55米，对于现代工程技术来说修桥和隧道都不是问题。</p>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/BeringSt-close-VE.jpg/600px-BeringSt-close-VE.jpg" /></p>
<p>如果中间那个岛做个中转站，那么两侧都各自30km左右。所以理论上从北京修一条到西雅图/加州的高铁完全没有问题。。</p>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/North_pole_map.jpeg/800px-North_pole_map.jpeg" /></p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-12-18T23:10:40+08:00">2023-12-18</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-17"  rel="bookmark" >
              <h2 class="card-title">query git notes with Github GraphQL</h2>
            </a>
            <p class="card-text"><p>git notes is an interesting feature, you can use it like </p>
<pre><code class="language-bash">git notes add -m &quot;hello test git notes&quot;
git push origin 'refs/notes/*'
</code></pre>
<p>Github supported them back <a href="https://github.blog/2010-08-25-git-notes-display/">in 2010</a> then gave up LMAO.</p>
<p>If you need to retrive them with Github API, try GraphQL like this</p>
<pre><code>  {
    repository(owner: "est", name: "snippets") {
      refs(refPrefix:"refs/notes/",first:1) {
        nodes{
          ... on Ref{
            target {
              oid
              ... on Commit{
                changedFilesIfAvailable
                message
                tree{
                  oid
                  entries{
                    oid
                    path
                    size
                    lineCount
                    mode
                    object{
                      ... on Blob{
                        byteSize
                        text
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
</code></pre>
<p>It will return something like:</p>
<pre><code>  {
    "data": {
      "repository": {
        "refs": {
          "nodes": [
            {
              "target": {
                "oid": "bfdfda121f3d8a2d6aa399e3e8f0d58b3db0a543",
                "changedFilesIfAvailable": 1,
                "message": "Notes added by 'git notes add'",
                "tree": {
                  "oid": "2ab3e6a8b0dff6596fa60ecfb3c61bf91e5b4e1f",
                  "entries": [
                    {
                      "oid": "404d353a254ffbc97b2e16d17b8c100461aef586",
                      "path": "4fb1272f1e235580f87e3ec071984658de050dc9",
                      "size": 21,
                      "lineCount": 1,
                      "mode": 33188,
                      "object": {
                        "byteSize": 21,
                        "text": "hello test git notes\n"
                      }
                    }
                  ]
                }
              }
            }
          ]
        }
      }
    }
  }
</code></pre>
<p>Here <code>"path": "4fb1272f1e235580f87e3ec071984658de050dc9"</code> is the commit SHA.</p>
<p>If you add more filter parameters in <code>refs()</code> you can fetch all the notes.</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-11-27T09:06:11+08:00">2023-11-27</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-16"  rel="bookmark" >
              <h2 class="card-title">VPS推荐：Hosteon</h2>
            </a>
            <p class="card-text"><p>继续<a href="/202012/stderr-012">上次 Racknerd</a> 之后发现这家还行。写了个<a href="https://github.com/est/snippets/blob/master/vps_scan/main.py">爬虫</a>扒了一下各色配置，独立服除外，有需要的自取</p>
<table>
<thead>
<tr>
<th>pid</th>
<th>spec</th>
<th>Disk</th>
<th>Bandwidth</th>
<th>Annual $</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=1">1</a></td>
<td>1C512M</td>
<td>5GB</td>
<td>100Mbps</td>
<td>$27.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=7">7</a></td>
<td>6C8G</td>
<td>100GB</td>
<td>100Mbps</td>
<td>$270.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=77">77</a></td>
<td>1C1G</td>
<td>10GB</td>
<td>1Tbps</td>
<td>$21.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=78">78</a></td>
<td>2C1.5G</td>
<td>20GB</td>
<td>2Tbps</td>
<td>$36.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=79">79</a></td>
<td>2C2G</td>
<td>25GB</td>
<td>3Tbps</td>
<td>$45.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=80">80</a></td>
<td>2C2.5G</td>
<td>30GB</td>
<td>4Tbps</td>
<td>$54.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=81">81</a></td>
<td>3C3G</td>
<td>40GB</td>
<td>5Tbps</td>
<td>$63.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=83">83</a></td>
<td>3C5G</td>
<td>50GB</td>
<td>8Tbps</td>
<td>$90.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=84">84</a></td>
<td>6C10G</td>
<td>120GB</td>
<td>12Tbps</td>
<td>$180.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=85">85</a></td>
<td>10C12G</td>
<td>150GB</td>
<td>15Tbps</td>
<td>$270.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=86">86</a></td>
<td>14C20G</td>
<td>200GB</td>
<td>20Tbps</td>
<td>$450.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=87">87</a></td>
<td>20C30G</td>
<td>300GB</td>
<td>30Tbps</td>
<td>$675.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=110">110</a></td>
<td>1C1G</td>
<td>15GB</td>
<td>2Tbps</td>
<td>$21.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=111">111</a></td>
<td>2C2G</td>
<td>20GB</td>
<td>4Tbps</td>
<td>$39.99</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=112">112</a></td>
<td>3C3G</td>
<td>30GB</td>
<td>6Tbps</td>
<td>$49.50</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=113">113</a></td>
<td>4C4G</td>
<td>40GB</td>
<td>8Tbps</td>
<td>$59.99</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=119">119</a></td>
<td>1C512M</td>
<td>10GB</td>
<td>500Gbps</td>
<td>$24.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=120">120</a></td>
<td>1C1G</td>
<td>15GB</td>
<td>1Tbps</td>
<td>$36.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=121">121</a></td>
<td>2C2G</td>
<td>30GB</td>
<td>2Tbps</td>
<td>$72.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=122">122</a></td>
<td>2C3G</td>
<td>50GB</td>
<td>3Tbps</td>
<td>$108.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=123">123</a></td>
<td>2C4G</td>
<td>70GB</td>
<td>4Tbps</td>
<td>$144.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=124">124</a></td>
<td>4C5G</td>
<td>90GB</td>
<td>5Tbps</td>
<td>$180.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=126">126</a></td>
<td>6C6G</td>
<td>100GB</td>
<td>6Tbps</td>
<td>$216.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=127">127</a></td>
<td>6C7G</td>
<td>120GB</td>
<td>7Tbps</td>
<td>$252.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=128">128</a></td>
<td>8C8G</td>
<td>140GB</td>
<td>8Tbps</td>
<td>$288.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=129">129</a></td>
<td>8C9G</td>
<td>150GB</td>
<td>9Tbps</td>
<td>$324.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=130">130</a></td>
<td>10C10G</td>
<td>170GB</td>
<td>10Tbps</td>
<td>$360.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=131">131</a></td>
<td>10C11G</td>
<td>180GB</td>
<td>11Tbps</td>
<td>$396.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=132">132</a></td>
<td>12C12G</td>
<td>200GB</td>
<td>12Tbps</td>
<td>$432.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=154">154</a></td>
<td>1C1G</td>
<td>20GB</td>
<td>4Tbps</td>
<td>$33.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=155">155</a></td>
<td>2C2G</td>
<td>30GB</td>
<td>6Tbps</td>
<td>$40.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=156">156</a></td>
<td>3C3G</td>
<td>40GB</td>
<td>8Tbps</td>
<td>$60.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=157">157</a></td>
<td>4C4G</td>
<td>50GB</td>
<td>10Tbps</td>
<td>$84.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=158">158</a></td>
<td>5C5G</td>
<td>60GB</td>
<td>12Tbps</td>
<td>$105.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=159">159</a></td>
<td>6C6G</td>
<td>70GB</td>
<td>14Tbps</td>
<td>$130.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=160">160</a></td>
<td>7C7G</td>
<td>80GB</td>
<td>16Tbps</td>
<td>$145.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=161">161</a></td>
<td>8C8G</td>
<td>90GB</td>
<td>18Tbps</td>
<td>$170.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=162">162</a></td>
<td>9C9G</td>
<td>100GB</td>
<td>20Tbps</td>
<td>$190.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=163">163</a></td>
<td>10C10G</td>
<td>110GB</td>
<td>22Tbps</td>
<td>$210.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=164">164</a></td>
<td>11C11G</td>
<td>120GB</td>
<td>24Tbps</td>
<td>$240.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=165">165</a></td>
<td>12C12G</td>
<td>130GB</td>
<td>26Tbps</td>
<td>$260.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=166">166</a></td>
<td>8C8G</td>
<td>50GB</td>
<td>30Tbps</td>
<td>$98.99</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=167">167</a></td>
<td>4C4G</td>
<td>25GB</td>
<td>15Tbps</td>
<td>$56.99</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=168">168</a></td>
<td>4C4G</td>
<td>25GB</td>
<td>15Tbps</td>
<td>$79.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=169">169</a></td>
<td>8C8G</td>
<td>50GB</td>
<td>30Tbps</td>
<td>$158.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=170">170</a></td>
<td>12C12G</td>
<td>75GB</td>
<td>30Tbps</td>
<td>$235.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=171">171</a></td>
<td>16C16G</td>
<td>100GB</td>
<td>30Tbps</td>
<td>$318.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=172">172</a></td>
<td>20C20G</td>
<td>125GB</td>
<td>30Tbps</td>
<td>$399.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=173">173</a></td>
<td>24C24G</td>
<td>150GB</td>
<td>30Tbps</td>
<td>$480.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=174">174</a></td>
<td>28C28G</td>
<td>175GB</td>
<td>30Tbps</td>
<td>$575.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=175">175</a></td>
<td>32C32G</td>
<td>200GB</td>
<td>30Tbps</td>
<td>$660.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=176">176</a></td>
<td>36C36G</td>
<td>225GB</td>
<td>30Tbps</td>
<td>$730.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=177">177</a></td>
<td>40C40G</td>
<td>250GB</td>
<td>30Tbps</td>
<td>$810.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=178">178</a></td>
<td>1C1G</td>
<td>20GB</td>
<td>2Tbps</td>
<td>$21.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=179">179</a></td>
<td>32C32G</td>
<td>1TB</td>
<td>1Gbps</td>
<td>$540.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=180">180</a></td>
<td>64C64G</td>
<td>1TB</td>
<td>1Gbps</td>
<td>$725.00</td>
</tr>
<tr>
<td><a href="https://my.hosteons.com/aff.php?aff=2128&amp;pid=181">181</a></td>
<td>128C128G</td>
<td>2x</td>
<td>1Gbps</td>
<td>$1850.00</td>
</tr>
</tbody>
</table></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-11-19T22:10:55+08:00">2023-11-19</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-15"  rel="bookmark" >
              <h2 class="card-title">太阳系天体的 unicode 符号</h2>
            </a>
            <p class="card-text"><p>发现<a href="https://en.wikipedia.org/wiki/Astronomical_symbols">Astronomical symbols</a>，<a href="https://en.wikipedia.org/wiki/Planet_symbols">Planet symbols<br />
</a> 及 <a href="https://en.wikipedia.org/wiki/Alchemical_symbol#Unicode">Alchemical symbol</a></p>
<table>
<thead>
<tr>
<th>IAU</th>
<th>七金</th>
<th>符号</th>
<th>名</th>
<th>name</th>
<th>星期</th>
<th>七曜</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>金</td>
<td>☉︎</td>
<td>太阳</td>
<td>Sun</td>
<td>星期天</td>
<td>日曜</td>
<td></td>
</tr>
<tr>
<td></td>
<td>银</td>
<td>☾</td>
<td>月球</td>
<td>Moon</td>
<td>星期一</td>
<td>月曜</td>
<td>也可以画成 ☽︎ <br>或者月相 🌑︎🌒︎🌓︎🌔︎🌕︎🌖︎🌗︎🌘︎，🌚︎🌛︎︎🌝︎︎🌜︎︎</td>
</tr>
<tr>
<td>H</td>
<td>汞</td>
<td>☿</td>
<td>水星</td>
<td>Mercury</td>
<td>星期三</td>
<td>水曜</td>
<td>赫耳墨斯(Hermes)，罗马人称 Mercury<br>现代人称「爱马仕」的双盘蛇带翼权杖 Caduceus <font size="5">☤</font></td>
</tr>
<tr>
<td>V</td>
<td>铜</td>
<td>♀</td>
<td>金星</td>
<td>Venus</td>
<td>星期五</td>
<td>金曜</td>
<td>维纳斯</td>
</tr>
<tr>
<td>E</td>
<td></td>
<td>🜨</td>
<td>地球</td>
<td>Earch</td>
<td></td>
<td></td>
<td><em>Bible</em> 里说的四条河把地球分成四洲<br>另外的符号是 ♁ 表示十字架钉个球 <em>globus cruciger</em></td>
</tr>
<tr>
<td>M</td>
<td>铁</td>
<td>♂</td>
<td>火星</td>
<td>Mars</td>
<td>星期二</td>
<td>火曜</td>
<td>符号是战神盾牌和长矛</td>
</tr>
<tr>
<td>J</td>
<td>锡</td>
<td>♃</td>
<td>木星</td>
<td>Jupiter</td>
<td>星期四</td>
<td>木曜</td>
<td>字母 Zeta（大写Ζ小写ζ）加一杠，代表宙斯/朱庇特</td>
</tr>
<tr>
<td>S</td>
<td>铅</td>
<td>♄</td>
<td>土星</td>
<td>Saturn</td>
<td>星期六</td>
<td>土曜</td>
<td>字母 kappa-rho ，表示 Kronos 加一杠<br>泰坦 克罗诺斯，宙斯他爹</td>
</tr>
<tr>
<td>U</td>
<td></td>
<td>⛢</td>
<td>天王星</td>
<td>Uranus</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td></td>
<td>♅</td>
<td>海王星</td>
<td>Neptune</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>几点：</p>
<ul>
<li>其中 金星/火星 符号被拿来代表 女/男 是1750年代Carl Linnaeus干的。 </li>
<li>冥王星 Pluto 发现的晚，占星术还没来得及改版就惨遭除名成矮行星。</li>
<li>星期和对应的天体意义，<a href="https://en.wikipedia.org/wiki/Names_of_the_days_of_the_week">全世界惊人的一致</a></li>
</ul>
<p>其它各种卫星，小行星的名字就懒得贴了。</p>
<p>有了这些符号，我们可以画一个比如托勒密的简化版太阳系模型：</p>
<p><img alt="" src="/images/2023/stdout-15-01.jpg" /></p>
<p>本文源自《<a href="https://www.cricetuscricetus.co.uk/post/copernicus-galileo-kepler-they-all-lacked-proof">哥白尼、伽利略、开普勒都是脱离证据拍脑袋撕逼</a>》一文。<a href="https://news.ycombinator.com/item?id=38300902">HN</a></p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-11-18T16:15:51+08:00">2023-11-18</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-14"  rel="bookmark" >
              <h2 class="card-title">Getting started blogging on Win10</h2>
            </a>
            <p class="card-text"><p>I am planning to setup by blogging environment on my Windows PC.</p>
<ul>
<li>OS: Windows 10</li>
<li>Shell: Bash on WSL1</li>
<li>Program: <code>pelican</code> on Miniconda3 with Python 3.11</li>
</ul>
<p>My objective today is get rid of the <code>static/js/core.js</code> from <code>aether-pelican</code> theme and replace it with <a href="https://jsfiddle.net/t78mf7jb/3/">a simple CSS</a>, and it turns out quite challenging.</p>
<h3>WSL1 and file system</h3>
<p>As it turns out, the installed Ubuntu root filesystem on WSL1 is located here:</p>
<p><code>%localappdata%\Packages\CanonicalGroupLimited.UbuntuonWindows_79rhkp1fndgsc\LocalState\rootfs</code></p>
<p>I plan to move my home dir (at least) to another SSD on my PC, as the <code>C:\</code> drive is an old SanDisk Plus240, which is unforgivablly slow these days. I tried to <code>mv ~ /mnt/d/home</code>, ok but the permission gets weird.</p>
<p>So I tried to copy the folder on Windows to <code>D:\home</code>, and <code>mklink</code> back. I tried both <code>mklink /D</code> and <code>mklink /J</code> ( the <code>/D</code> switch works on a remote drive whereas the <code>/J</code> junction works on local NTFS disks only) and they both failed be recognized by WSL1. The bash yields <code>Broken stdout/stdin</code> upon launch</p>
<p>So OK, default home dir then. Bad luck for me.</p>
<h3>Ubuntu 22</h3>
<p>I just found out my <code>cat /etc/lsb-release</code> shows Ubuntu 18, which is the default distro installed on <code>WSL1</code> I assume. I tried to install Ubuntu 22 from the Microsoft Store, after several wasted minutes (curse the slow Internet in Mainland!) it turns out for WSL2 only. Luckily the Windows Subsystem for Linux was successfully upgraded to latest version:</p>
<pre><code>C:\&gt; wsl --version
WSL version: 1.2.5.0
Kernel version: 5.15.90.1
WSLg version: 1.0.51
MSRDC version: 1.2.3770
Direct3D version: 1.608.2-61064218
DXCore version: 10.0.25131.1002-220531-1700.rs-onecore-base2-hyp
Windows version: 10.0.19045.3570
</code></pre>
<p>the <code>wsl --list --online</code> commands stuck for a total of 10 minutes and returns nothing (curse the AS4134 163NET!)</p>
<h3>Getting Python, Miniconda and Pelican</h3>
<p>So linux distro setup was back to where started, I only have Python to mess with. Miniconda3 gets insalled easily, now that's a some progress. The static site generator I am using <code>pip install pelican[markdown]</code> finishes ok, the pypi was not blocked? Keke.</p>
<p>Then I typed <code>make</code>. It was not part of WSL1? Blaspheme!</p>
<p>Manually running <code>python -m pelican.server</code>, and voila! The Windows asks for firewall listening permission, granted, open up browser, BAM! My blog setup process is done and now I can write and tweak it on Windows. </p>
<p>Oh, and there's <code>git config core.fileMode false</code> needs to be checked!</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-11-11T10:31:11+08:00">2023-11-11</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-13"  rel="bookmark" >
              <h2 class="card-title">火星上怎么结算工资</h2>
            </a>
            <p class="card-text"><p>看到个段子</p>
<p><img alt="" src="/images/2023/stdout-13-01.jpg" /></p>
<p>突然让我想起个事，如果去火星打工，薪资该怎么计算？摘录 wikipedia</p>
<blockquote>
<p>火星的恒星时长 <code>24小时37分钟22.663秒</code>，而太阳日则长 <code>24小时39分钟35.24409</code> 秒。而地球的恒星时和太阳日则分别是 <code>23小时56分钟4.0916秒</code> 及 <code>24小时</code>。在比较之下，一火星太阳日等于1.027491地球太阳日，即比地球太阳日长2.7%。</p>
</blockquote>
<p>怎么有两个天？继续搜</p>
<blockquote>
<p>太阳日（英语：solar day）是依据太阳运动，所定义的时间，可以分为视觉太阳日和平均太阳日。一太阳日传统称为一“日”、一“天”或一“昼夜”。</p>
</blockquote>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Sidereal_day_%28prograde%29.png/600px-Sidereal_day_%28prograde%29.png" /></p>
<p>英语里把火星的一天叫做一个 <code>Sol</code>。一个火星年在英文的 wikipedia 有讲</p>
<blockquote>
<p>sidereal year ... is about 686.98 Earth solar days (≈ 1.88 Earth years), or <code>668.5991</code> sols 。也就是说火星一年有 668.5991 火星天。。。</p>
</blockquote>
<p>火星因为有<code>25.19°</code>的自转倾角，跟地球相近，所以也可以划分四季。但问题是，火星的轨道长这样：</p>
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Mars_earth_orbit.png/600px-Mars_earth_orbit.png" /></p>
<p>所以如果按照四个季节划分，最长的季节有 <code>194 个 Martian Sols</code>，最短的 <code>142 Martian sols</code></p>
<p>那么问题来了。在火星上怎么算工资呢？我觉得得安天结了。还有，假如亲爱的读者小伙伴将来到火星务工，应聘的时候一定确认好是按地球年结算还是火星年哦。谨防火星历诈骗！</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-11-09T15:50:11+08:00">2023-11-09</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stderr-15"  rel="bookmark" >
              <h2 class="card-title">跟孩子掰扯活着的意义</h2>
            </a>
            <p class="card-text"><p>今天趁着11·11买了个 GZ104 黄轴键盘，感觉之前随便买的青轴的好了很多，于是手痒想打字。哈哈</p>
<h2>人的意义 是什么</h2>
<p>娃今天吃饭的时候突然问了我一个问题：「人活着的意义是什么呀」，很不凑巧我也闲来无事琢磨过这事，但是想要在孩子面前把这事说清楚可能没那么容易。</p>
<p>于是我换了个思路，我问他，如果你是一个动物，你觉得意义是什么？他没回答，我又问，如果你是一块石头，石头会考虑自己的意义嘛？</p>
<p>孩子也没回答。最后我说，人活着的意义呀，可能很多人也不知道，但是有一点可以确定，正因为你有一个聪明的小脑袋，才会去思考「什么是意义」这样的问题</p>
<h2>国家是什么</h2>
<p>他又问到，为什么世界上有那么多国家呢，为什么联合国不是一个国家。怎么样才能统一全世界成为一个国家。</p>
<p>我的回答又把刚才的套路重复了一遍。如果你是一只动物，你会觉得自己属于某个国家吗？娃想了下，可能不会吧。我看到碗里的饭说，如果你是一粒大米，你会觉得自己有国家吗，孩子也不说话。最后我说，国家有很多个定义，但是正是因为人有了大脑，有了想象力，才会产生国家这个概念。所谓国家，就是一个想象的共同体。</p>
<h2>反思</h2>
<p>这可能是我会记录的最无聊的两件事。因为我真的想拿着键盘痛快的打一打字哈哈。</p>
<p>或许我的回答都不是最好的，现在想起来真的有很多改进之处。比如没能鼓励孩子进一步对这个问题进行探索。</p>
<p>蹲茅坑的时候想了一下，我们小时候哪里会思考这些问题呀。小时候都在为了作业发愁，心思都花在了怎么玩上面。现在的孩子能思考这些问题说明生活条件比较好了。人在穷的时候，物质匮乏的时候是不会去思考存在的意义的，都忙着奔波生活去了。生存都照顾不过来，如何去顾及意义呢。</p>
<p>生命或许最大的意义就是生存。仅仅丰衣足食之后，才有闲心来考虑一下奋斗折腾这么大半辈子，究竟是图了个啥。</p>
<h1>后记</h1>
<p>本文完成于 2023-11-05 22:39:59。  </p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-11-05T22:26:35+08:00">2023-11-05</time></p>
<p>stderr</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-12"  rel="bookmark" >
              <h2 class="card-title">FastAPI/Starlette graceful shutdown server-sent events</h2>
            </a>
            <p class="card-text"><h3>缘起</h3>
<p>假如你用 FastAPI/Starlette框架，写了一段 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events">Server-sent Events</a></p>
<pre><code class="language-python">@app.get('/api/my_stream')
async def api_stream():
  async def gen():
    while 1:
      yield &quot;data: {}\n\n&quot;
      await asyncio.sleep(1.0)

  return StreamingResponse(gen, media_type=&quot;text/event-stream&quot;, headers={
    'X-Accel-Buffering': 'no',
    'Cache-Control': &quot;no-cache&quot;,
    'Connection': &quot;keep-alive&quot;,
  })
</code></pre>
<h3>FastAPI 事件</h3>
<p>然后你重启了服务器，比如 gunicorn+uvicorn，你会发现这个连接不会断开，一直输出结果。直到 worker 进程超过配置里的 <code>timeout</code> 参数（默认60秒），被 master 强行杀死然后重启。</p>
<p>一开始尝试了 <a href="https://fastapi.tiangolo.com/advanced/events/#shutdown-event">FastAPI 官方的 <code>shutdown</code> 事件</a>，再在代码的 <code>while 1</code> 加一个 <code>if</code> 判断。发现不管用</p>
<pre><code class="language-python">@app.on_event('shutdown')
def on_server_shutdown():
    app.state.running = False
</code></pre>
<p>发现这段代码执行是执行了，但是是在杀死worker的时候生效的。得更加提前。用<a href="https://asgi.readthedocs.io/en/latest/specs/lifespan.html">ASGI推荐的<code>lifespan</code></a>和 <a href="https://asgi.readthedocs.io/en/latest/specs/www.html#disconnect-receive-event"><code>http.disconnect</code></a> 太复杂，放弃。</p>
<h3>Linux signal</h3>
<p>尝试暴力监听 worker signal</p>
<pre><code class="language-python">import signal
signal.signal(signal.SIGINT, on_server_shutdown)  # ctrl+c
signal.signal(signal.SIGUSR2, on_server_shutdown)
signal.signal(signal.SIGTERM, on_server_shutdown)
signal.signal(signal.SIGWINCH, on_server_shutdown)
signal.signal(signal.SIGHUP, on_server_shutdown)
signal.signal(signal.SIGQUIT, on_server_shutdown)
</code></pre>
<p>发现也不管用。研究了半天，似乎是 <code>UvicornWorker.init_signals</code> 的时候<a href="https://github.com/encode/uvicorn/issues/894">给<code>signal.SIG_DFL</code>了</a>。无语ing</p>
<h3>uvicorn shutdown 流程</h3>
<p>看gunicorn日志：</p>
<pre><code>[2023-11-02 09:50:38 +0800] [25918] [INFO] Shutting down
[2023-11-02 09:50:38 +0800] [25918] [INFO] Waiting for application shutdown.
[2023-11-02 09:50:38 +0800] [25918] [INFO] Waiting for connections to close. (CTRL+C to force quit)
....
[2023-11-02 09:51:18 +0800] [25918] [INFO] Application shutdown complete.
[2023-11-02 09:51:18 +0800] [25918] [INFO] Finished server process [25918]
[2023-11-02 09:51:18 +0800] [25918] [INFO] Worker exiting (pid: 25918)
</code></pre>
<p>观察到 Waiting for connections to close 之后卡住。</p>
<p>属于 uvicorn 的 <a href="](https://github.com/encode/uvicorn/blob/07c2b36455b5475ff7edfa54068ff2c0581a2be1/uvicorn/server.py#L303)"><code>Server.shutdown()</code></a> 方法</p>
<p>这个方法调用链：</p>
<ol>
<li><code>Server.install_signal_handlers</code> 里注册 signal </li>
<li><code>Server.handle_exit</code> 里设置 <code>Server.should_exit = True</code></li>
<li>每秒一次的 <code>Server.on_tick</code> 就会打断 <code>Server.main_loop()</code> 死循环</li>
<li>调用 <code>Server.shutdown</code></li>
</ol>
<p>如果能拿到 <code>Server.should_exit</code> 自行判断就好了，但是 ASGI 是容器无感的，只继续研究</p>
<h3>断开http连接</h3>
<p>上面日志有一个比较关键：</p>
<pre><code class="language-python"># Request shutdown on all existing connections.
for connection in list(self.server_state.connections):
    connection.shutdown()
    await asyncio.sleep(0.1)
</code></pre>
<p>其http连接关闭方法实现为：</p>
<pre><code class="language-python">def shutdown(self):
    &quot;&quot;&quot;
    Called by the server to commence a graceful shutdown.
    &quot;&quot;&quot;
    if self.cycle is None or self.cycle.response_complete:
        self.transport.close()
    else:
        self.cycle.keep_alive = False
</code></pre>
<p>这里应该走的是 <code>else</code> 分支。所以解决方法就是去代码里拿到 <code>cycle.keep_alive</code> 这个属性。</p>
<h3>ASGI 接口</h3>
<p>跟了一会儿，发现ASGI 在  starlette 里如下流程：</p>
<ol>
<li><code>Route()</code> 初始化 <code>self.app = request_response(endpoint)</code></li>
<li><code>Route().handle()</code> 的时候会调用 <code>self.app(scope, receive, send)</code></li>
<li><code>unicorn</code> 的 <code>run_asgi</code> 会 <code>result = await app(self.scope, self.receive, self.send)</code> 。其中 <code>app</code> 就是 starlette 的 <code>Route()</code> 实例</li>
</ol>
<p>所以解决方案逐渐明朗了</p>
<h3>黎明的前夜</h3>
<p>通过 FastAPI/Starlette 请求的 <code>.receive</code> 属性的 <code>__self__</code> 拿到 unicorn 的 <code>cycle</code> 实例，然后定时判断上面 <code>shutdown</code> 赋值的 <code>self.cycle.keep_alive = False</code></p>
<pre><code class="language-python">@app.get('/api/my_stream')
async def api_stream(req: Request):
  async def gen():
    while 1:
      yield &quot;data: {}\n\n&quot;
      await asyncio.sleep(1.0)
      if getattr(req.receive.__self__, 'keep_alive', None) is False:
        break

  return StreamingResponse(...
</code></pre>
<p>这里用了个 <code>getattr()</code> 是保证这个 hack 在非 unicorn 下代码也能正常跑</p>
<p><code>git commit . -m "haha"</code> 上机联调，发现坑了。。。我特么。。。。这个 <code>cycle.keep_alive</code> 默认就是 <code>False</code></p>
<h3>扭转 keep_alive</h3>
<p>这玩意一直为 <code>False</code> 的原因是，unicorn 的 <code>HttpToolsProtocol.on_headers_complete</code> 赋值过程：</p>
<p><code>self.cycle = RequestResponseCycle(..., keep_alive=http_version != "1.0")</code></p>
<p>这里 <code>http_version</code> 可以通过  <code>req.scope['http_version']</code> 得到，打印了一下，你猜怎么着，还真tm是。。。原因就是厂里反代 <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_http_version">nginx的proxy_http_version</a>没配置。这里是个常见的坑，非常影响性能，因为每个请求会生成一个新的 http 连接。</p>
<p>但是也等不急SA去改配置了。于是直接在代码 <code>async def gen():</code> 前面写死：</p>
<p><code>req.receive.__self__.keep_alive = True</code> 。提交，再试。。。咦，怎么 <code>keep_alive</code> 依然为 <code>False</code>？？？？明明刚刚赋值了？</p>
<p>继续读代码，发现第二个坑，发现 unicorn 的 <code>RequestResponseCycle.send()</code> 方法里，在构造返回的时候，有一句</p>
<pre><code class="language-python">for name, value in headers:
    elif name == b&quot;connection&quot; and value.lower() == b&quot;close&quot;:
        self.keep_alive = False
</code></pre>
<p>好吧。。。那么解决方法就是，把 <code>keep_alive = True</code> 挪到返回内部。先完成返回构造，再强行改值。</p>
<h4>最后的代码</h4>
<pre><code class="language-python">@app.get('/api/my_stream')
async def api_stream(req: Request):
  # req.receive.__self__.keep_alive = True  # doesn't work here
  async def gen():
    req.receive.__self__.keep_alive = True  # works here
    while 1:
      yield &quot;data: {}\n\n&quot;
      await asyncio.sleep(1.0)
      if req.receive.__self__.keep_alive is False:
        break

  return StreamingResponse(gen, media_type=&quot;text/event-stream&quot;, headers={
    'X-Accel-Buffering': 'no',
    'Cache-Control': &quot;no-cache&quot;,
    'Connection': &quot;keep-alive&quot;,
  })
</code></pre>
<p>测试重启 worker，该连接在1秒后断开，worker平稳重启。完美。</p>
<p>苦逼撸业务的一天又开始了。</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-11-02T09:44:12+08:00">2023-11-02</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-11"  rel="bookmark" >
              <h2 class="card-title">浏览器拉起钉钉客户端并跳转OA工单</h2>
            </a>
            <p class="card-text"><p>又是 corporate software engineering 吃屎的一天。用户在内部系统走流程，厂里用的是钉钉自带的OA工单审批。已经接入了API创建、完成工单</p>
<p>问题在于发起工单之后，用户并没有感知，不知道工单去哪里了，流程就断了，向钉钉官方售后发起咨询，对方丢了一句：不支持。无语</p>
<p>只能自己鼓捣。已知工单链接，在钉钉聊天窗口内部的最短的网址为：</p>
<pre><code>  https://aflow.dingtalk.com/dingtalk/mobile/homepage.htm?corpid=...&amp;procInstId=...#approval
</code></pre>
<p>对方丢了一个 <a href="https://open.dingtalk.com/document/isvapp/webapp-unified-routing-protocol#title-kkq-kgx-lbq">dingtalk:// 跳转协议</a></p>
<p>反复尝试，发现一个很有用：</p>
<blockquote>
<p>桌面端打开URL <br />
<code>dingtalk://dingtalkclient/page/link</code> <br />
侧边栏： <code>pc_slide=true</code> <br />
大容器（类似工作台容器）<code>ddtab=true</code>   </p>
</blockquote>
<p>于是构造一个试试：</p>
<pre><code>  dingtalk://dingtalkclient/page/link?url=https%3A%2F%2Faflow.dingtalk.com%2Fdingtalk%2Fpc%2Fquery%2Fpchomepage.htm%3Fcorpid%3D...%26procInstId%3D...%23%2Fapproval
</code></pre>
<p>然后果然ok了。</p>
<p>钉钉给人的感觉就是各个部门 hack 强行揉合起来一个怪物。各种不完善、不一致的问题。有空写一下吐槽。</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-10-18T14:57:00+08:00">2023-10-18</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-10"  rel="bookmark" >
              <h2 class="card-title">SVG放在 img 中不能加载图片/字体</h2>
            </a>
            <p class="card-text"><p>最近想在 markdown 里搞图文混排，遇到一个大图把版面占完了，想缩小一些，由于 .md 渲染器安全限制，没法直接指定宽高</p>
<p>只能从图片本身想办法，首先最直接的手段就是服务器再缩放一次，但是蛋痛的问题是缩放之后文件怎么存，怎么给静态文件路由，怎么保障图片可用性，怎么兼容各种尺寸，想想都头大。</p>
<p>想到一个 hack，要不直接放一个 .svg 进去，因为 svg 支持加载位图资源，所以把 svg 位图缩小一点，让浏览器渲染 svg 不就行了。</p>
<p>没想到就被这个 hack 坑了。原因是 svg 如果被 <code>&lt;img&gt;</code> 标签渲染，那么禁止加载任何外部资源，脚本也禁止执行。</p>
<p>为了证明这个限制，我写了个 demo 放在 <a href="https://lab.est.im/shit_svg/">https://lab.est.im/shit_svg/</a></p>
<p>这个问题太隐蔽了。stackoverflow 上只有 <a href="https://stackoverflow.com/a/30467585/41948">Robert Longson</a>、<a href="https://stackoverflow.com/a/69160093/41948">ThangLeQuoc</a>、<a href="https://stackoverflow.com/a/18244035/41948#18244035">TheHippo<br />
</a> 的答案提到隐约线索：</p>
<p>后来搜了到 <a href="https://supercodepower.com/en/svg-img-use-font">skychx</a> 把这个问题研究透了。罪魁祸首 <a href="https://www.w3.org/wiki/SVG_Security">SVG Security</a></p>
<blockquote>
<p>If an SVG file is fetched as image, then certain requirements apply to this document:   </p>
<ul>
<li>The SVG document is not allowed to fetch any resources. This also applies to scripts, stylesheets or images.   </li>
<li>Fonts shouldn't be loaded as well. The situation in UAs seems to still be unclear though.<br />
Scripts must not be executed.   </li>
<li>Event listeners must be disabled at all times.   </li>
</ul>
</blockquote>
<p>浪费我好多时间。SVG2里把这个说得很明白了 <a href="https://www.w3.org/TR/SVG2/conform.html#processing-modes">https://www.w3.org/TR/SVG2/conform.html#processing-modes</a></p>
<blockquote>
<p>When external references are disabled in an SVG document, any attempt to fetch a document through an external reference must instead be treated as if a network error occurred and no data was received.</p>
</blockquote>
<p>不过查阅资料的时候发现个好玩的，<a href="https://www.w3.org/TR/SVG11/single-page.html#linking-LinksIntoSVG">SVG 1.1 支持 URL fragments</a></p>
<p>比如：</p>
<ul>
<li>原图 <a href="https://lab.est.im/shit_svg/1.svg">https://lab.est.im/shit_svg/1.svg</a> <embed src="https://lab.est.im/shit_svg/1.svg"></li>
<li>放大 <a href="https://lab.est.im/shit_svg/1.svg#svgView(viewBox(20,20,60,60))">https://lab.est.im/shit_svg/1.svg#svgView(viewBox(20,20,60,60))</a> <embed src="https://lab.est.im/shit_svg/1.svg#svgView(viewBox(20,20,60,60))"></li>
</ul></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-10-17T22:13:18+08:00">2023-10-17</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stdout-09"  rel="bookmark" >
              <h2 class="card-title">市以上行政区划去掉后缀</h2>
            </a>
            <p class="card-text"><p>今天才知道，中国一共333个市一级行政单位。数据来源是 <a href="https://www.mca.gov.cn/n156/index.html">民政部首页 ➡ 民政数据</a></p>
<pre><code>import re

def short_name(name):
    m = re.search(r'''
        (\S+?)
        (?:
            壮族|回族|维吾尔|省|自治区|特别|  # 省
            (?:侗|傈僳|傣|哈尼|回|土家|壮|布依|彝|景颇|朝鲜|白|羌|苗|藏)族|
            蒙古|柯尔克孜|哈萨克|
            地区|市|盟|自治州|自治县
        ).*$
    ''', name, re.VERBOSE)
    if m:
        return m.group(1)
    return name
</code></pre>
<p>这段代码的作用是把比如 <code>"黔南布依族苗族自治州"</code> 这样的名字，缩短成 <code>"黔南"</code>。</p>
<p>有一个小坑是，市一级行政区包含 <code>蒙古|柯尔克孜|哈萨克</code> 这三个名字后面没有 <code>族</code> 字。</p>
<p>有一些 <code>XX林区</code> <code>XX矿区</code> 什么的，我觉得保留比较好。</p>
<p>Python的 <code>re.VERBOSE</code> 真是好东西！</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-10-12T20:01:23+08:00">2023-10-12</time></p>
<p>stdout</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stderr-14"  rel="bookmark" >
              <h2 class="card-title">B站百大up 和 国拟</h2>
            </a>
            <p class="card-text"><p>bilibili.com 是国内热门长视频网站，俗称B站，百大UP是头部百万粉丝的视频上传者，前段时间无聊看了下《<a href="https://www.bilibili.com/video/BV17N411E7ry/">征集两万份问卷！全站最受欢迎的UP主居然是..?</a>》，这部视频作者 <code>-LKs-</code> 抛出了一个惊世骇俗（对我而言）的理论：</p>
<p><img alt="" src="/images/2023/stderr-14-01.webp" /></p>
<blockquote>
<p>频道和频道之间，天生就有占领心智和认知上的高低之分<br />
记忆点排名：人设≥情绪≈观点&gt;颜值&gt;知识/新闻`<br />
一般来说输出情绪和观点的频道，它一定会比那些输出知识和资讯的频道，要更容易被人记住和喜欢。因为前者的拟态更接近人，后者的拟态更接近「书」</p>
</blockquote>
<p>注意它这句话有前提：</p>
<ol>
<li>第一他说的是，一个频道作为一个品牌如何被人记住和喜欢</li>
<li>第二他说是记住和喜欢，并没有说频道的内容一定正确或者有效</li>
<li>第三它不是说一个频道对你有多少帮助。完全有可能你偶然遇到或者搜到一个频道帮你解决了一个问题但是你把频道的名字得一干二净</li>
</ol>
<p>想起来，这也是为啥youtube/bilibili上很多视频封面都是各种大头照，以 LinusTechTips为例：</p>
<p><img alt="" src="/images/2023/stderr-14-03.webp" /></p>
<p>让人们记住一个鲜明的大活人，人设最重要啊。</p>
<p>无独有偶，今天又看到一则奇闻《<a href="https://zhuanlan.zhihu.com/p/660461624">不得不出“国区特供版”的波兰球，是怎么火进小学生圈子里的？</a>》，简单的说 Steam 上出了一款波兰球游戏「Bang On Balls Chronicles」结果波兰球这个亚文化早就在国内流传开并在小学生里成功的「娘」化了</p>
<p><img alt="" src="/images/2023/stderr-14-02.webp" /></p>
<p>得出一个道理：自己对世界的理解，要去人化，祛魅脱敏；对品牌和迷因的传播，要拟人化萌娘化。</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-10-10T21:34:41+08:00">2023-10-10</time></p>
<p>stderr</p>            </div>
          </article>
        </div>


        <!-- new article -->
        <div class="card blog-card">
          <article class="card-body">
            <a href="/2023/stderr-13"  rel="bookmark" >
              <h2 class="card-title">核心阶级和国家认同</h2>
            </a>
            <p class="card-text"><p>最近看到个巨扯谈的视频《<a href="https://www.bilibili.com/video/BV1U94y1h7th/">个人主义盛行的美国是怎么建立国家认同的</a>》</p>
<details>
  <summary>剧透</summary>
  美国早期本来是一个松散的13邦联盟，互相尿不到一壶里去，但是联邦政府作为一个可以名义上筹钱筹人的机构，在1803年的Louisiana Purchase得到了大量的未开发土地，种植园主和牧场主为了个人的发财梦，去和北美土著诸部火并，拿起枪杆子保卫自己亲自或者祖辈抢来的土地，13邦的边界虽然明确，但是联邦政府在默许拓边这一行为，并且应允境外白人用 税款 换取 联邦指派治安官和联邦武力的庇护。在对北美土著采取离间驱逐的过程中逐渐形成国家认同。
</details>

<p>实际上，美国这一血腥的国家认同，正是在上个世纪30年代<a href="https://www.washingtonpost.com/outlook/2021/07/13/long-history-american-nazism-why-we-cant-forget-it-today/">纳粹主义的渊源之一（wapo有讲）</a>。简单的说，发现美洲之后，敢离开老欧洲漂洋过海的人都是胆大包天的亡命之徒。它们信奉的昭昭天命就是「应许之地」，加上新教核心理念就是「sola fide」，我强我有理，有理我就强，所以我就是比其他物种优越。最后发展成种族主义，实施对其他 race 的压迫。</p>
<p>这个视频的 up 主是「思维实验室」，他们家的视频有一些说不清道不明的诡异但的地方但是题材比较有趣。这个视频很方便的忽略了一个更有趣 whataboutism 的问题：太平洋对岸的国家认同是怎么建立的？</p>
<p>有理由相信，华夏的国家认同建立正是<a href="https://www.zhihu.com/question/361172362">武装殖民</a>。</p>
<p><img alt="" src="/images/2023/stderr-13-01.jpg" /></p>
<p>白寿彝版《中国通史》在论述周初分封制直接说这就是武装殖民。</p>
<blockquote>
<p>周初的分封是一种武装驻防事业，其目的主要在于作为王室的助手，以监视被征服的各族人民，实际上它具有武装部落殖民的性质。我们知道，周王当时所能直接统治的只有王巍之地。王畿是以镐京和洛邑为两个焦点，其范围现在不能确考，但可知其北不过黄河，南不到汉水，东不达淮水，西则镐京已接近边陲。王畿之外，周室先后封立了很多诸侯国，诸侯对王室的义务不过按期纳贡朝觐，出兵助王征伐，以及救济畿内的灾患而已。诸侯国的内政几乎完全自主，而王室开国初年的武王成王过去以后，诸侯对王室的义务也就成了具文。<br />
另一方面，所有新建的封国大都是以少数周族奴隶主贵族统治多数被征服族人，其土既非周人所有，其民也与周人不类，这些新来者的统治地位，如果没有坚强的武力作其后盾是支持不住的。姜太公封到东方的营邱，史书说太公就东国，“夜衣而行，犁（黎）明至国。莱侯来伐，与之争营丘。”“营丘边莱，莱人，夷也”（均见《史记·齐太公世家》），新来的统治者占有其土地，拥有其人民，因而起来反抗。《礼记·檀弓上》云：“太公封于营丘，比及五世，皆反葬于周”，可见当时武装殖民之不易。当时被封的周族奴隶主贵族及其所率领的周族公社农民进入广大占领区后，首先建立一个军事据点，这在古代文献中名之曰“城”，只有如此，才能进行武力镇压。《诗经·小雅·黍苗》中召穆公营谢，诗人描述军族集镇之况云：“我任我辇，我车我牛，我行既集，盖云归哉！我徒我御，我师我旅，我行既集，盖云归处！”周人及其姻戚联盟，造邦筑城，镇戍征服地区，也见于周金铭文，例如《中甗》虽然铭文残泐，颇难卒读，但其大意，尚可通晓。意谓：王派中巡省南国，筑城殖民，并派兵镇戍。《班毁》记毛公伐东国■戎，■令班“■（以）乃族从父（毛父）征，■（出）■（城）卫。”毛公东征“三年静东国”。这里的■（城）就是征服筑城之证。</p>
</blockquote>
<p>这个段子说，姜子牙去山东「上任」，实际上也就给了一点亲兵和战车，地盘要自己去抢，城要自己去建，太公当年差点被山东当地一个叫「莱」的土著部落给搞死……</p>
<p>为什么少数民族总是「能歌善舞」，并且大多住在偏远的山区？是不是换个译法就是 …… tribal reservation？</p>
<p>这让我想起另一个段子：<a href="https://www.zhihu.com/question/618318252">《封神》导演乌尔善说【汉族称谓】形成于元代。</a></p>
<p>下面有个评论就很应景：「汉族是不是起源自元代，我不知道，但是我知道，“我是汉人”的意识是这些其它民族一遍一遍给我加强的」</p>
<p>这里有个感觉，无论是「通天纹大妈」，还是玩梗的「正米字旗」老不列颠，还是「红旗下长大」的大院子弟，对阶级的认同度远远大于普通国民。因为天下是他们或者他们的祖辈打下来的，有一种「股东感」。如果是普通人，和平年代的国籍无非是身份证件上的可以花代价更改的一行字罢了。</p>
<p>如果你读到这里，一定要暂停一下。如果你觉得这个太宏观，那么假想一下你去了个新公司。你跟普通同事交谈的是，今天做了哪些工作，明天又有哪些该死的任务下来；但是公司里总有那么一戳人，他们跟你讲公司的视角完全不同。他们会告诉你 A 这个市场是当年谁谁大干30天拿下的，B 这个股份是谁谁奋斗了几年才成为合伙人得到的，C 这个部门之前没有，是谁谁带资进组专门成立的。D 这个烂摊子之所以一直没解决是因为负责人跑路到友商，等等。那么把同等的视角换到国家，统治者或者他们的家属后代会明确告诉你，某某领土的由来就是谁谁当年打下来的，而且他们在这样的一种「传承」体系中，非常自豪。</p>
<p>这就是为啥平时很多 XX盟 XX旗 XX喇嘛教 会看不起汉人的根本原因。别人对某一篇山川有「ownership」的感觉。汉文化一个比较短视缺陷就是把天下看成一种零和博弈，「百姓」需要把自己一部分权力让渡给「君主」，人权需要迁就主权，但从唯物的角度来说，国家总是由一小部分人打下来的，大多数被土地绑定的人，并没有太多选择，作为 X国人 或 X朝人 的资格，只能是来自统治者的「施舍」。所以鱼肉百姓也是理所当然顺理其章的事了。因为人口就脱离了人的属性，只是附属和资产。</p>
<p>又联系起最近看马督工的 睡前消息652期《<a href="https://www.zhihu.com/question/618318252">只靠民间热情，“山河大学”建不起来</a>》，里面谈到高中 - 职校分流问题，现实中全世界成功的职业教育有且只有德国一家。职校前身实际上是行业 (学术概念：基尔特) 里师徒制的正规化(1969 <em>Berufsausbildungsgesetz</em>)。我有一个偏激的观点，职校早期雏形是条顿军官团拿来生产军需屯田和筹款的产物。容克军户在和平年代转型生产制造和银行业，大量的德意志职校几乎都是围绕汽车产业进行布局，归根结底就是一堆战备产业。</p>
<p>所以谁才是国家的主人？血与火铸成的核心利益阶级(class)</p>
<p>Class 是一个神奇的词汇，OOP的「类」和社会的「阶级」有异曲同工之妙。如果按照本篇思路推演下去，可以拿历朝历代作为例子总结一下朝代的消亡的实质，就是核心class的消解：</p>
<ul>
<li>周人的核心阶级是老姬家。三家分晋之后gg。公卿代替天子</li>
<li>大秦是一个神奇的国度，变法之后不分种族和阶级，以法治世，但是功勋升级系统在大一统之后达到武力扩张极限被玩坏反噬了。汉王定三秦，算老秦人第二次统一中国。</li>
<li>老刘家彻底扫平沛县集团还得等到刘彻的大手笔。当时看 渤海小吏 的 《<a href="https://space.bilibili.com/504934876/channel/collectiondetail?sid=1589161">汉武大帝</a>》系列就有如同看开篇第一个视频讲的美国西部精神，牛仔风范那种爽片一样。李广难封，老刘家对野心家封无可封就造就了曹阿瞒加九锡这种操作</li>
<li>老李家核心阶级是关陇集团。安世之乱就是河北土著（主要是汉人）和陕西外籍雇佣军团冲突</li>
<li>辽金的核心阶级显然是拓跋部和猛安谋克，大怂国本质是一群胸无大志但是筹款能力比其他朝代强的节度使混日子</li>
<li>元的核心阶级就是千户制达鲁花赤老爷们</li>
<li>明的核心阶级是军户供养皇族养猪。军户跑光了也该亡国了</li>
<li>大清的核心阶级是八旗。满城沦陷就完蛋</li>
<li>本朝的核心阶级是 ☭ </li>
</ul>
<p>除了核心阶级所形成的可以继承的利益集团，其他人要么是归顺的食邑劳动力，要么是“穷凶极恶”的印第安人。</p></p>
            <div class="card-subtext muted-text">
              <p>Posted <time datetime="2023-10-07T07:34:04+08:00">2023-10-07</time></p>
<p>stderr</p>            </div>
          </article>
        </div>

    </main>
    <nav class="pagination-nav side-padding">
<a href="/index.03.html" class="pagination-newer">&lt; Newer Posts</a><a href="/index.05.html" class="pagination-older">Older Posts &gt;</a>    </nav>


  </body>
</html>