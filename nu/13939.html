<!DOCTYPE html>
<html>
  <head>
    <title>[åŸ]C#å’ŒIEã€Maxthonå…±äº«session cookie - ğŸ‘â€ğŸ—¨ ğŸ’­ ğŸ’« ğŸ…±ã’</title>

    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link href="https://feeds.feedburner.com/initiative" type="application/rss+xml" rel="alternate" title="ğŸ‘â€ğŸ—¨ ğŸ’­ ğŸ’« ğŸ…±ã’ RSS Feed" />

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="[åŸ]C#å’ŒIEã€Maxthonå…±äº«session cookie" />

      <link rel="canonical" href="https://blog.est.im/nu/13939" />

    <link rel="stylesheet" href="/theme/css/normalize.min.css" />
    <link rel="stylesheet" href="/theme/css/style.css" />


    <style>
      body {
        background: #ecedef url("/theme/img/ignasi_pattern_s.png") repeat;
      }
    </style>
  </head>
  <body class="single-body">
<nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="/" class="nav-text">
    ğŸ‘â€ğŸ—¨ ğŸ’­ ğŸ’« ğŸ…±ã’
  </a></h1>
  <div class="hamburger-menu">
    <button onclick="hamburgerMenuPressed.call(this)" aria-haspopup="true" aria-expanded="false" aria-controls="menu" aria-label="Menu">
      <span></span>
      <span></span>
    </button>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="/" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://feeds.feedburner.com/initiative" class="hamburger-menu-overlay-link">RSS</a></li>
      <li><a href="/about" class="hamburger-menu-overlay-link">About</a></li>

      <li><a href="/category/archive" class="hamburger-menu-overlay-link active">archive</a></li>
      <li><a href="/category/stderr" class="hamburger-menu-overlay-link">stderr</a></li>
      <li><a href="/category/stdin" class="hamburger-menu-overlay-link">stdin</a></li>
      <li><a href="/category/stdout" class="hamburger-menu-overlay-link">stdout</a></li>

    </ul>
  </div>
</nav>    <main class="content side-text-padding">


<article class="post">
  <header class="post-header">
    <h2 class="post-title">[åŸ]C#å’ŒIEã€Maxthonå…±äº«session cookie</h2>
    <p class="post-date">Posted <time datetime="2007-03-31T14:17:00+08:00">2007-03-31</time> | <span>archive</span></p>
  </header>

  
  <p>æœ€è¿‘å†™ç”µå­ç§‘å¤§æ•™åŠ¡å¤„çš„è‡ªåŠ¨é€‰ç§‘ç³»ç»Ÿï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœå…ˆåœ¨ www.tad.uestc.edu.cn ç™»é™†äº†ï¼Œå†ç”¨æœºå™¨ç™»é™†å¹¶è‡ªåŠ¨é€‰è¯¾ï¼Œé‚£ä¹ˆIE/Maxthonå°±ä¼šæç¤ºï¼šä½ çš„å¸å·å·²åœ¨åˆ«å¤„ç™»é™†ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªå¸å·åªèƒ½æœ‰ä¸€ä¸ª session ä¸æœåŠ¡å™¨ç›¸è¿ï¼Œé‚£ä¹ˆå¯å¦å®ç°æˆ‘ä»¬çš„ã€Šè‡ªåŠ¨é€‰è¯¾æœºã€‹ä¸IEå…±äº« session ï¼Œä¹Ÿå°±æ˜¯è¯´ä»¥åŒä¸€ä¸ªcookieå’ŒæœåŠ¡å™¨å¯¹è¯å‘¢ï¼Ÿæƒ³äº†å¥½ä¹…ï¼Œæœ‰å‡ ä¸ªæ€è·¯ï¼Œä¸€æ˜¯ç”¨Win32APIå‘é€çª—ä½“æ¶ˆæ¯ï¼Œä½†æ˜¯IEå®åœ¨å¤ªå¤æ‚ï¼›äºŒæ˜¯æ‹¦æˆªWinSockçš„åŒ…ï¼Œè¿™æ ·å®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒå›°éš¾ï¼Œç¬¬ä¸‰å°±æ˜¯ç”¨IEçš„æ¥å£æ¥è·å–cookieä¿¡æ¯äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¥å£æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¾ç„¶ .NET æ²¡æœ‰ç›´æ¥æä¾›ï¼Œé‚£ä¹ˆå°±åªæœ‰åˆ° COM é‡Œå¯»æ‰¾äº†ï¼Œå¯¹äº†ï¼ŒWSH/VBSé‡Œæœ‰ä¸€ä¸ªç€åçš„å¯¹è±¡ï¼šInternetExplorer.Applicationï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„IEçª—å£ï¼Œä¾‹å¦‚ä¸‹é¢çš„vbsï¼š </p>
<p>Set objIE =CreateObject(&quot;InternetExplorer.Application&quot;)<br/>
objIE.Navigate(&quot;<a href="http://www.tad.uestc.edu.cn/%22)"><font color="#669966">http://www.tad.uestc.edu.cn/&quot;)</font></a><br/>
objIE.Visible=True<br/>
WScript.Sleep 1000 'ç­‰å¾…é¡µé¢è½½å…¥<br/>
MsgBox objIE.Document.cookie</p>
<p>ç ”ç©¶äº†ä¸‹ç”¨C#å®ŒæˆåŒæ ·çš„æ“ä½œï¼ŒçœŸæ˜¯éº»çƒ¦å•Šï¼Œå±…ç„¶ç”¨åˆ°äº†åå°„ã€‚signï¼Œå¤§å®¶å¯ä»¥å¯¹æ¯”ä¸‹ä»£ç æ•°é‡ï¼š </p>
<p>&nbsp;</p>
<p>using System;<br/>
using System.Collections.Generic;<br/>
using System.ComponentModel;<br/>
using System.Data;<br/>
using System.Drawing;<br/>
using System.Text;<br/>
using System.Windows.Forms;<br/>
using System.Net;<br/>
using System.Reflection;<br/>
using System.Threading;</p>
<p>namespace WindowsApplication3<br/>
{<br/>
&nbsp;&nbsp;&nbsp; public partial class Form1 : Form<br/>
&nbsp;&nbsp;&nbsp; {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WebClient wc;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type tp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type tpDocument;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object ie;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object IEDocument;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Form1()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void Form1_Load(object sender, EventArgs e)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp = Type.GetTypeFromProgID(&quot;InternetExplorer.Application&quot;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ie = Activator.CreateInstance(tp); //å…¶å®ä¸Šé¢è¿™ä¹ˆå¤šä»£ç å°±åšäº†ä¸€ä»¶äº‹æƒ…ï¼šCreateObject()ï¼Œæˆ–è€…è¯´JScripté‡Œé¢çš„new ActiveXObject()</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp.InvokeMember(&quot;Navigate&quot;, BindingFlags.InvokeMethod, null, ie, new object[] { &quot;<a href="http://www.tad.uestc.edu.cn">http://www.tad.uestc.edu.cn</a>&quot; }); //ç›¸å½“äº ie.Navigate(&quot;<a href="http://www.tad.uestc.edu.cn">http://www.tad.uestc.edu.cn</a>&quot;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp.InvokeMember(&quot;Visible&quot;, BindingFlags.SetProperty, null, ie, new object[] { true }); //ç›¸å½“äº ie.Visible=ture<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Thread.Sleep(1000); //ç­‰å¾…é¡µé¢è½½å…¥ï¼Œå¦åˆ™ä¼šå‡ºç° HRESULT é”™è¯¯<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IEDocument = tp.InvokeMember(&quot;Document&quot;, BindingFlags.GetProperty, null, ie, null); //è·å¾— ie.Document å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ª mshtml.HtmlDocument COMå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯JScripté‡Œçš„DOMï¼Œä¾‹å¦‚ window.document<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tpDocument = IEDocument.GetType();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void button1_Click(object sender, EventArgs e)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; textBox1.Text=tpDocument.InvokeMember(&quot;cookie&quot;, BindingFlags.GetProperty, null, IEDocument, null).ToString(); //ç›¸å½“äº ie.Document.cookieã€‚<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œç”¨C#æ“ä½œCOMæ˜¯ç›¸å½“éº»çƒ¦çš„ã€‚VBSå‡ å¥è¯ï¼ŒC#å°±ä¼šå†™å¤§æ®µçš„ä»£ç ï¼Œå¾ˆå¤šæ˜¯é‡å¤çš„ï¼Œéƒ½æ˜¯ä¸ºäº†ä¸‡æ¶çš„strong typeã€‚è¿˜æ˜¯è„šæœ¬å¥½å•Šï¼Œå…å»äº†å¾ˆå¤šåå°è½¬æ¢ä»£ç ï¼Œå‘µå‘µã€‚<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //å†™COM Interopæœ€éº»çƒ¦çš„å°±æ˜¯å¼‚å¸¸å¤„ç†äº†ï¼Œå¾ˆå¤š HRESULT ä¸çŸ¥é“æ€ä¹ˆåŠï¼Œéƒé—·ã€‚å¾®è½¯çš„å…¼å®¹æ€§çœŸç³Ÿç³•ï¼<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void Form1_Leave(object sender, EventArgs e)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>
&nbsp;&nbsp;&nbsp; }<br/>
}</p>
<p><img alt="" src="http://dormforce.net/Blog/Attachment/749"/></p>
<p>[å†…æœ‰é™„ä»¶]</p>
<p><img src ="http://dormforce.net/Blog/electronixtar/aggbug/13939.aspx" width = "1" height = "1" /></p>

</article>


<div class="comments">
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'estblog';
    var disqus_identifier = 'nu/13939';
    var disqus_url = location.href;
    (function() {
    var dsq = document.createElement('script'); 

    dsq.type = 'text/javascript';
    dsq.defer = true;
    dsq.src = '//estblog.disqus.com/embed.js';
    (document.getElementsByTagName('body')[0] || document.getElementsByTagName('head')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the comments.</noscript>
</div>    </main>
<script src="/theme/js/core.js"></script>

  </body>

</html>